{"version":3,"sources":["../node_modules/@arcgis/core/views/interactive/snapping/featureSources/GraphicsSnappingSource.js","../node_modules/@arcgis/core/geometry/support/normalizeUtilsSync.js","../node_modules/@arcgis/core/core/libs/rbush/PooledRBush.js","../node_modules/@arcgis/core/layers/graphics/data/optimizedFeatureQueryEngineAdapter.js","../node_modules/@arcgis/core/layers/graphics/data/BoundsStore.js","../node_modules/@arcgis/core/layers/graphics/data/FeatureStore.js","../node_modules/@arcgis/core/views/interactive/snapping/candidates/VertexSnappingCandidate.js","../node_modules/@arcgis/core/views/interactive/snapping/featureSources/queryEngineUtils.js"],"names":["O","e","availability","sources","multipoint","point","polygon","polyline","loadedWkids","Set","loadedWkts","pendingAdds","this","updatingHandles","updating","layerSource","layer","length","task","abort","mapSources","destroySource","handles","add","on","onGraphicUpdate","addOnCollectionChange","graphics","onGraphicsChanged","addMany","toArray","t","a","r","queryEngine","executeQueryForSnapping","coordinateHelper","toPoint","c","toJSON","distance","types","query","o","filter","createQuery","where","then","candidates","flat","map","k","v","property","remove","graphic","removed","added","Map","s","i","geometry","needsInitializeProjection","spatialReference","push","set","uid","createPendingAdd","n","u","source","dest","signal","markLoadedSpatialReferences","addPromise","promise","wkid","wkt","visible","type","l","fromExtent","ensureSource","createOptimizedFeature","featureStore","has","h","m","y","S","f","b","createSource","g","j","geometryType","hasZ","hasM","w","fields","name","alias","objectIdField","scheduler","view","resourceController","removeFromSource","delete","size","removeById","destroy","p","constructOnly","prototype","readOnly","d","J","isWebMercator","I","maxX","minX","plus180Line","minus180Line","N","points","x","M","xmin","ymin","xmax","ymax","cut","valid","frameId","extent","frameIds","rings","Array","isArray","Math","ceil","abs","closed","minPts","paths","compareMinX","compareMinY","toBBox","_maxEntries","max","_minEntries","_initFormat","clear","prune","X","Y","B","_all","data","children","leaf","pop","insert","_build","slice","height","_splitRoot","_insert","indexHint","splice","_condense","pushArray","log","sqrt","min","_chooseSubtree","_split","_adjustParentBBoxes","_chooseSplitAxis","_chooseSplitIndex","console","_allDistMargin","sort","Function","join","minY","maxY","deallocator","arguments","getObjectId","objectId","getAttributes","attributes","getAttribute","cloneWithGeometry","getGeometry","getCentroid","centroid","_indexInvalid","_boundsToLoad","_boundsById","_idByBounds","_index","_loadIndex","forEach","load","get","search","geometryInfo","_boundsStore","_featuresById","_markedIds","events","featureAdapter","numFeatures","coords","featureCount","vertexCount","_add","_emitChanged","_remove","invalidateIndex","forEachInBounds","emit","displayId","onFeatureAdd","getLogger","error","feature","onFeatureRemove","constraint","targetPoint","edgeStart","fromPoint","start","edgeEnd","end","target"],"mappings":"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","file":"static/js/65.02e4b130.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Accessor.js\";import{removeUnordered as r}from\"../../../../core/arrayUtils.js\";import{HandleOwnerMixin as s}from\"../../../../core/HandleOwner.js\";import{isSome as o,isNone as i}from\"../../../../core/maybe.js\";import{eachAlwaysValues as a,createTask as n}from\"../../../../core/promiseUtils.js\";import{property as p}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/Logger.js\";import{subclass as d}from\"../../../../core/accessorSupport/decorators/subclass.js\";import c from\"../../../../geometry/Point.js\";import l from\"../../../../geometry/Polygon.js\";import{initializeProjection as u,canProjectWithoutEngine as h,project as m}from\"../../../../geometry/projection.js\";import{normalizeCentralMeridianSync as y}from\"../../../../geometry/support/normalizeUtilsSync.js\";import{featureGeometryTypeKebabDictionary as g}from\"../../../../geometry/support/typeUtils.js\";import{convertFromGeometry as f}from\"../../../../layers/graphics/featureConversionUtils.js\";import S from\"../../../../layers/graphics/OptimizedFeature.js\";import j from\"../../../../layers/graphics/data/FeatureStore.js\";import w from\"../../../../layers/graphics/data/QueryEngine.js\";import{sortCandidatesInPlace as v}from\"../snappingUtils.js\";import{convertSnappingCandidate as k}from\"./queryEngineUtils.js\";let O=class extends(s(t)){constructor(e){super(e),this.availability=1,this.sources={multipoint:null,point:null,polygon:null,polyline:null},this.loadedWkids=new Set,this.loadedWkts=new Set,this.pendingAdds=[]}get updating(){return this.updatingHandles.updating}get layer(){return this.layerSource.layer}destroy(){const e=this.pendingAdds;this.pendingAdds.length=0;for(const t of e)t.task.abort();this.mapSources((e=>this.destroySource(e)))}initialize(){this.handles.add([this.layer.on(\"graphic-update\",(e=>this.onGraphicUpdate(e))),this.updatingHandles.addOnCollectionChange(this.layer.graphics,(e=>this.onGraphicsChanged(e)))]),this.addMany(this.layer.graphics.toArray())}async fetchCandidates(e,t){const r=(await a(this.mapSources((r=>r.queryEngine.executeQueryForSnapping({point:e.coordinateHelper.toPoint(e.point,new c).toJSON(),distance:e.distance,types:e.types,query:o(e.filter)?e.filter.createQuery().toJSON():{where:\"1=1\"}},t).then((({candidates:e})=>e)))))).flat().map((t=>k(t,e.coordinateHelper)));return v(e.point,r),r}refresh(){}onGraphicUpdate(e){switch(e.property){case\"geometry\":case\"visible\":this.remove(e.graphic),this.addMany([e.graphic])}}onGraphicsChanged(e){for(const t of e.removed)this.remove(t);this.addMany(e.added)}addMany(e){const t=[],r=new Map;for(const s of e)i(s.geometry)||(this.needsInitializeProjection(s.geometry.spatialReference)?(t.push(s.geometry.spatialReference),r.set(s.uid,s)):this.add(s));this.createPendingAdd(t,r)}createPendingAdd(e,t){if(!e.length)return;const s=n((async r=>{await u(e.map((e=>({source:e,dest:this.spatialReference}))),{signal:r}),this.markLoadedSpatialReferences(e);for(const[,e]of t)this.add(e)}));this.updatingHandles.addPromise(s.promise);const o={task:s,graphics:t},i=()=>r(this.pendingAdds,o);s.promise.then(i,i),this.pendingAdds.push(o)}markLoadedSpatialReferences(e){for(const t of e)null!=t.wkid&&this.loadedWkids.add(t.wkid),null!=t.wkt&&this.loadedWkts.add(t.wkt)}add(e){if(i(e.geometry)||!e.visible)return;let t=e.geometry;if(\"mesh\"===t.type)return;\"extent\"===t.type&&(t=l.fromExtent(t));const r=this.ensureSource(t.type);if(i(r))return;const s=this.createOptimizedFeature(e.uid,t);o(s)&&r.featureStore.add(s)}needsInitializeProjection(e){return(null==e.wkid||!this.loadedWkids.has(e.wkid))&&((null==e.wkt||!this.loadedWkts.has(e.wkt))&&!h(e,this.spatialReference))}createOptimizedFeature(e,t){const r=m(y(t),this.spatialReference);return r?new S(f(r,!1,!1),{[b]:e},null,e):null}ensureSource(e){const t=this.sources[e];if(o(t))return t;const r=this.createSource(e);return this.sources[e]=r,r}createSource(e){const t=g.toJSON(e),r=new j({geometryType:t,hasZ:!1,hasM:!1});return{featureStore:r,queryEngine:new w({featureStore:r,fields:[{name:b,type:\"esriFieldTypeOID\",alias:b}],geometryType:t,hasM:!1,hasZ:!1,objectIdField:b,spatialReference:this.spatialReference,scheduler:o(this.view)&&\"3d\"===this.view.type?this.view.resourceController.scheduler:null}),type:e}}remove(e){this.mapSources((t=>this.removeFromSource(t,e)));for(const t of this.pendingAdds)t.graphics.delete(e.uid),0===t.graphics.size&&t.task.abort()}removeFromSource(e,t){const r=t.uid;e.featureStore.has(r)&&e.featureStore.removeById(t.uid)}destroySource(e){e.queryEngine.destroy(),this.sources[e.type]=null}mapSources(e){const{point:t,polygon:r,polyline:s,multipoint:i}=this.sources,a=[];return o(t)&&a.push(e(t)),o(r)&&a.push(e(r)),o(s)&&a.push(e(s)),o(i)&&a.push(e(i)),a}};e([p({constructOnly:!0})],O.prototype,\"spatialReference\",void 0),e([p({constructOnly:!0})],O.prototype,\"layerSource\",void 0),e([p({constructOnly:!0})],O.prototype,\"view\",void 0),e([p({readOnly:!0})],O.prototype,\"updating\",null),e([p({readOnly:!0})],O.prototype,\"availability\",void 0),O=e([d(\"esri.views.interactive.snapping.featureSources.GraphicsSnappingSource\")],O);const b=\"OBJECTID\";export{O as GraphicsSnappingSource};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{create as n}from\"./aaBoundingRect.js\";import{getBoundsXY as t}from\"./boundsUtils.js\";import{extentIntersectsPolyline as i}from\"./intersectsBase.js\";import{isPoint as s,isMultipoint as m,isExtent as e,isPolygon as x,isPolyline as o}from\"./jsonUtils.js\";import{cutParams as r,getGeometryParts as a,offsetMagnitude as f}from\"./normalizeUtilsCommon.js\";import{getInfo as c}from\"./spatialReferenceUtils.js\";function l(n){if(!n)return null;if(\"mesh\"===n.type)return n.toJSON();let a=null;const l=n.spatialReference,h=c(l);if(!h)return n.toJSON();const d=l.isWebMercator?102100:4326,I=r[d].maxX,g=r[d].minX,b=r[d].plus180Line,v=r[d].minus180Line;let J;const N=n.toJSON();if(s(N))J=y(N,I,g);else if(m(N))N.points=N.points.map((n=>y(n,I,g))),J=N;else if(e(N))J=p(N,h);else if(x(N)||o(N)){const n=M;t(n,N);const s={xmin:n[0],ymin:n[1],xmax:n[2],ymax:n[3]},m=f(s.xmin,g)*(2*I),e=0===m?N:u(N,m);s.xmin+=m,s.xmax+=m,i(s,b)&&s.xmax!==I||i(s,v)&&s.xmin!==g?a=e:J=e}else J=n.toJSON();if(null!==a){return(new j).cut(a,I)}return J}function u(n,t){const i=a(n);for(const s of i)for(const n of s)n[0]+=t;return n}function p(n,t){if(!t)return n;const i=h(n,t).map((n=>n.extent));return i.length<2?i[0]||n:i.length>2?(n.xmin=t.valid[0],n.xmax=t.valid[1],n):{rings:i.map((n=>[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]))}}function y(n,t,i){if(Array.isArray(n)){const s=n[0];if(s>t){const i=f(s,t);n[0]=s+i*(-2*t)}else if(s<i){const t=f(s,i);n[0]=s+t*(-2*i)}}else{const s=n.x;if(s>t){const i=f(s,t);n.x+=i*(-2*t)}else if(s<i){const t=f(s,i);n.x+=t*(-2*i)}}return n}function h(n,t){const i=[],{ymin:s,ymax:m}=n,e=n.xmax-n.xmin,x=n.xmin,o=n.xmax;let r;const[a,f]=t.valid;r=d(n.xmin,t);const c=r.x,l=r.frameId;r=d(n.xmax,t);const u=r.x,p=r.frameId,y=c===u&&e>0;if(e>2*f){const n={xmin:x<o?c:u,ymin:s,xmax:f,ymax:m},t={xmin:a,ymin:s,xmax:x<o?u:c,ymax:m},e={xmin:0,ymin:s,xmax:f,ymax:m},r={xmin:a,ymin:s,xmax:0,ymax:m},y=[],h=[];I(n,e)&&y.push(l),I(n,r)&&h.push(l),I(t,e)&&y.push(p),I(t,r)&&h.push(p);for(let i=l+1;i<p;i++)y.push(i),h.push(i);i.push({extent:n,frameIds:[l]},{extent:t,frameIds:[p]},{extent:e,frameIds:y},{extent:r,frameIds:h})}else c>u||y?i.push({extent:{xmin:c,ymin:s,xmax:f,ymax:m},frameIds:[l]},{extent:{xmin:a,ymin:s,xmax:u,ymax:m},frameIds:[p]}):i.push({extent:{xmin:c,ymin:s,xmax:u,ymax:m},frameIds:[l]});return i}function d(n,t){const[i,s]=t.valid,m=2*s;let e,x=0;return n>s?(e=Math.ceil(Math.abs(n-s)/m),n-=e*m,x=e):n<i&&(e=Math.ceil(Math.abs(n-i)/m),n+=e*m,x=-e),{x:n,frameId:x}}function I(n,t){const{xmin:i,ymin:s,xmax:m,ymax:e}=t;return g(n,i,s)&&g(n,i,e)&&g(n,m,e)&&g(n,m,s)}function g(n,t,i){return t>=n.xmin&&t<=n.xmax&&i>=n.ymin&&i<=n.ymax}class j{cut(n,t){let i;if(n.rings)this.closed=!0,i=n.rings,this.minPts=4;else{if(!n.paths)return null;this.closed=!1,i=n.paths,this.minPts=2}const s=i.length,m=-2*t;for(let e=0;e<s;e++){const n=i[e];if(n&&n.length>=this.minPts){const t=[];for(const i of n)t.push([i[0]+m,i[1]]);i.push(t)}}return this.closed?n.rings=i:n.paths=i,n}}const M=n();export{l as normalizeCentralMeridianSync};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{indexOf as t,PositionHint as i}from\"../../arrayUtils.js\";import{assumeNonNull as n}from\"../../maybe.js\";import e from\"../../PooledArray.js\";import{q as s}from\"../../../chunks/quickselect.js\";class h{constructor(t=9,i){this.compareMinX=l,this.compareMinY=c,this.toBBox=function(t){return t},this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),i&&(\"function\"==typeof i?this.toBBox=i:this._initFormat(i)),this.clear()}destroy(){this.clear(),M.prune(),X.prune(),Y.prune(),B.prune()}all(t){this._all(this.data,t)}search(t,i){let n=this.data;const e=this.toBBox;if(p(t,n))for(M.clear();n;){for(let s=0,h=n.children.length;s<h;s++){const h=n.children[s],a=n.leaf?e(h):h;p(t,a)&&(n.leaf?i(h):x(t,a)?this._all(h,i):M.push(h))}n=M.pop()}}collides(t){let i=this.data;const n=this.toBBox;if(!p(t,i))return!1;for(M.clear();i;){for(let e=0,s=i.children.length;e<s;e++){const s=i.children[e],h=i.leaf?n(s):s;if(p(t,h)){if(i.leaf||x(t,h))return!0;M.push(s)}}i=M.pop()}return!1}load(t){if(!t.length)return this;if(t.length<this._minEntries){for(let i=0,n=t.length;i<n;i++)this.insert(t[i]);return this}let i=this._build(t.slice(0,t.length),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){const t=this.data;this.data=i,i=t}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=new b([]),this}remove(i){if(!i)return this;let e,s=this.data,h=null,a=0,r=!1;const o=this.toBBox(i);for(Y.clear(),B.clear();s||Y.length>0;){var l;if(!s)s=n(Y.pop()),h=Y.data[Y.length-1],a=null!=(l=B.pop())?l:0,r=!0;if(s.leaf&&(e=t(s.children,i,s.children.length,s.indexHint),-1!==e))return s.children.splice(e,1),Y.push(s),this._condense(Y),this;r||s.leaf||!x(s,o)?h?(a++,s=h.children[a],r=!1):s=null:(Y.push(s),B.push(a),a=0,h=s,s=s.children[0])}return this}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,i){let n=t;for(X.clear();n;){var e;if(!0===n.leaf)for(const t of n.children)i(t);else X.pushArray(n.children);n=null!=(e=X.pop())?e:null}}_build(t,i,n,e){const s=n-i+1;let h=this._maxEntries;if(s<=h){const e=new b(t.slice(i,n+1));return a(e,this.toBBox),e}e||(e=Math.ceil(Math.log(s)/Math.log(h)),h=Math.ceil(s/h**(e-1)));const r=new j([]);r.height=e;const o=Math.ceil(s/h),l=o*Math.ceil(Math.sqrt(h));g(t,i,n,l,this.compareMinX);for(let a=i;a<=n;a+=l){const i=Math.min(a+l-1,n);g(t,a,i,o,this.compareMinY);for(let n=a;n<=i;n+=o){const s=Math.min(n+o-1,i);r.children.push(this._build(t,n,s,e-1))}}return a(r,this.toBBox),r}_chooseSubtree(t,i,n,e){for(;e.push(i),!0!==i.leaf&&e.length-1!==n;){let n,e=1/0,s=1/0;for(let h=0,a=i.children.length;h<a;h++){const a=i.children[h],r=m(a),o=d(t,a)-r;o<s?(s=o,e=r<e?r:e,n=a):o===s&&r<e&&(e=r,n=a)}i=n||i.children[0]}return i}_insert(t,i,n){const e=this.toBBox,s=n?t:e(t);Y.clear();const h=this._chooseSubtree(s,this.data,i,Y);for(h.children.push(t),o(h,s);i>=0&&Y.data[i].children.length>this._maxEntries;)this._split(Y,i),i--;this._adjustParentBBoxes(s,Y,i)}_split(t,i){const n=t.data[i],e=n.children.length,s=this._minEntries;this._chooseSplitAxis(n,s,e);const h=this._chooseSplitIndex(n,s,e);if(!h)return void console.log(\"  Error: assertion failed at PooledRBush._split: no valid split index\");const r=n.children.splice(h,n.children.length-h),o=n.leaf?new b(r):new j(r);o.height=n.height,a(n,this.toBBox),a(o,this.toBBox),i?t.data[i-1].children.push(o):this._splitRoot(n,o)}_splitRoot(t,i){this.data=new j([t,i]),this.data.height=t.height+1,a(this.data,this.toBBox)}_chooseSplitIndex(t,i,n){let e,s,h;e=s=1/0;for(let a=i;a<=n-i;a++){const i=r(t,0,a,this.toBBox),o=r(t,a,n,this.toBBox),l=f(i,o),c=m(i)+m(o);l<e?(e=l,h=a,s=c<s?c:s):l===e&&c<s&&(s=c,h=a)}return h}_chooseSplitAxis(t,i,n){const e=t.leaf?this.compareMinX:l,s=t.leaf?this.compareMinY:c;this._allDistMargin(t,i,n,e)<this._allDistMargin(t,i,n,s)&&t.children.sort(e)}_allDistMargin(t,i,n,e){t.children.sort(e);const s=this.toBBox,h=r(t,0,i,s),a=r(t,n-i,n,s);let l=u(h)+u(a);for(let r=i;r<n-i;r++){const i=t.children[r];o(h,t.leaf?s(i):i),l+=u(h)}for(let r=n-i-1;r>=i;r--){const i=t.children[r];o(a,t.leaf?s(i):i),l+=u(a)}return l}_adjustParentBBoxes(t,i,n){for(let e=n;e>=0;e--)o(i.data[e],t)}_condense(i){for(let n=i.length-1;n>=0;n--){const e=i.data[n];if(0===e.children.length)if(n>0){const s=i.data[n-1],h=s.children;h.splice(t(h,e,h.length,s.indexHint),1)}else this.clear();else a(e,this.toBBox)}}_initFormat(t){const i=[\"return a\",\" - b\",\";\"];this.compareMinX=new Function(\"a\",\"b\",i.join(t[0])),this.compareMinY=new Function(\"a\",\"b\",i.join(t[1])),this.toBBox=new Function(\"a\",\"return {minX: a\"+t[0]+\", minY: a\"+t[1]+\", maxX: a\"+t[2]+\", maxY: a\"+t[3]+\"};\")}}function a(t,i){r(t,0,t.children.length,i,t)}function r(t,i,n,e,s){s||(s=new b([])),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let h,a=i;a<n;a++)h=t.children[a],o(s,t.leaf?e(h):h);return s}function o(t,i){t.minX=Math.min(t.minX,i.minX),t.minY=Math.min(t.minY,i.minY),t.maxX=Math.max(t.maxX,i.maxX),t.maxY=Math.max(t.maxY,i.maxY)}function l(t,i){return t.minX-i.minX}function c(t,i){return t.minY-i.minY}function m(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,i){return(Math.max(i.maxX,t.maxX)-Math.min(i.minX,t.minX))*(Math.max(i.maxY,t.maxY)-Math.min(i.minY,t.minY))}function f(t,i){const n=Math.max(t.minX,i.minX),e=Math.max(t.minY,i.minY),s=Math.min(t.maxX,i.maxX),h=Math.min(t.maxY,i.maxY);return Math.max(0,s-n)*Math.max(0,h-e)}function x(t,i){return t.minX<=i.minX&&t.minY<=i.minY&&i.maxX<=t.maxX&&i.maxY<=t.maxY}function p(t,i){return i.minX<=t.maxX&&i.minY<=t.maxY&&i.maxX>=t.minX&&i.maxY>=t.minY}function g(t,i,e,h,a){const r=[i,e];for(;r.length;){const i=n(r.pop()),e=n(r.pop());if(i-e<=h)continue;const o=e+Math.ceil((i-e)/h/2)*h;s(t,o,e,i,a),r.push(e,o,o,i)}}const M=new e,X=new e,Y=new e,B=new e({deallocator:void 0});class _{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class w extends _{constructor(){super(...arguments),this.height=1,this.indexHint=new i}}class b extends w{constructor(t){super(),this.children=t,this.leaf=!0}}class j extends w{constructor(t){super(),this.children=t,this.leaf=!1}}export default h;export{_ as BBox,h as PooledRBush};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{getCentroidOptimizedGeometry as t}from\"../centroid.js\";import e from\"../OptimizedFeature.js\";import r from\"../OptimizedGeometry.js\";const o={getObjectId:t=>t.objectId,getAttributes:t=>t.attributes,getAttribute:(t,e)=>t.attributes[e],cloneWithGeometry:(t,r)=>new e(r,t.attributes,null,t.objectId),getGeometry:t=>t.geometry,getCentroid:(e,o)=>(e.centroid||(e.centroid=t(new r,e.geometry,o.hasZ,o.hasM)),e.centroid)};export default o;export{o as optimizedFeatureQueryEngineAdapter};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport i from\"../../../core/has.js\";import{PooledRBush as s}from\"../../../core/libs/rbush/PooledRBush.js\";const d=5e4,n={minX:0,minY:0,maxX:0,maxY:0};function t(i,s,d){n.minX=s[0],n.minY=s[1],n.maxX=s[2],n.maxY=s[3],i.search(n,d)}class e{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new s(9,i(\"csp-restrictions\")?i=>({minX:i[0],minY:i[1],maxX:i[2],maxY:i[3]}):[\"[0]\",\"[1]\",\"[2]\",\"[3]\"]),this._loadIndex=()=>{if(this._indexInvalid){const i=new Array(this._idByBounds.size);let s=0;this._idByBounds.forEach(((d,n)=>{i[s++]=n})),this._indexInvalid=!1,this._index.clear(),this._index.load(i)}else this._boundsToLoad.length&&(this._index.load(this._boundsToLoad.filter((i=>this._idByBounds.has(i)))),this._boundsToLoad.length=0)}}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(i){const s=this._boundsById.get(i);this._boundsById.delete(i),s&&(this._idByBounds.delete(s),this._indexInvalid||this._index.remove(s))}forEachInBounds(i,s){this._loadIndex(),t(this._index,i,(i=>s(this._idByBounds.get(i))))}get(i){return this._boundsById.get(i)}has(i){return this._boundsById.has(i)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(i,s){if(!this._indexInvalid){const s=this._boundsById.get(i);s&&(this._index.remove(s),this._idByBounds.delete(s))}this._boundsById.set(i,s),s&&(this._idByBounds.set(s,i),this._indexInvalid||(this._boundsToLoad.push(s),this._boundsToLoad.length>d&&this._loadIndex()))}}export{e as BoundsStore};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Error.js\";import t from\"../../../core/Evented.js\";import r from\"../../../core/Logger.js\";import{isSome as s}from\"../../../core/maybe.js\";import{fromRect as o}from\"../../../geometry/support/aaBoundingBox.js\";import{create as i,NEGATIVE_INFINITY as a}from\"../../../geometry/support/aaBoundingRect.js\";import{getBoundsOptimizedGeometry as d}from\"../featureConversionUtils.js\";import{BoundsStore as n}from\"./BoundsStore.js\";import{optimizedFeatureQueryEngineAdapter as h}from\"./optimizedFeatureQueryEngineAdapter.js\";class u{constructor(e){this.geometryInfo=e,this._boundsStore=new n,this._featuresById=new Map,this._markedIds=new Set,this.events=new t,this.featureAdapter=h}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){if(!this.numFeatures)return null;const e=i(a);return this._featuresById.forEach((t=>{const r=this._boundsStore.get(t.objectId);r&&(e[0]=Math.min(r[0],e[0]),e[1]=Math.min(r[1],e[1]),e[2]=Math.max(r[2],e[2]),e[3]=Math.max(r[3],e[3]))})),e}get storeStatistics(){let e=0;return this._featuresById.forEach((t=>{t.geometry&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}add(e){this._add(e),this._emitChanged()}addMany(e){for(const t of e)this._add(t);this._emitChanged()}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(e){const t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}removeManyById(e){this._boundsStore.invalidateIndex();for(const t of e){const e=this._featuresById.get(t);e&&this._remove(e)}this._emitChanged()}forEachBounds(e,t,r){for(const s of e){const e=this._boundsStore.get(s.objectId);e&&t(o(r,e))}}getFeature(e){return this._featuresById.get(e)}has(e){return this._featuresById.has(e)}forEach(e){this._featuresById.forEach((t=>e(t)))}forEachInBounds(e,t){this._boundsStore.forEachInBounds(e,(e=>{t(this._featuresById.get(e))}))}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let e=!1;this._featuresById.forEach(((t,r)=>{this._markedIds.has(r)||(e=!0,this._remove(t))})),this._markedIds.clear(),e&&this._emitChanged()}_emitChanged(){this.events.emit(\"changed\",void 0)}_add(t){if(!t)return;const o=t.objectId;if(null==o)return void r.getLogger(\"esri.layers.graphics.data.FeatureStore\").error(new e(\"featurestore:invalid-feature\",\"feature id is missing\",{feature:t}));const a=this._featuresById.get(o);let n;if(this._markedIds.add(o),a?(t.displayId=a.displayId,n=this._boundsStore.get(o),this._boundsStore.delete(o)):s(this.onFeatureAdd)&&this.onFeatureAdd(t),!t.geometry||!t.geometry.coords||!t.geometry.coords.length)return this._boundsStore.set(o,null),void this._featuresById.set(o,t);n=d(n||i(),t.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(o,n),this._featuresById.set(o,t)}_remove(e){return s(this.onFeatureRemove)&&this.onFeatureRemove(e),this._markedIds.delete(e.objectId),this._boundsStore.delete(e.objectId),this._featuresById.delete(e.objectId),e}}export default u;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{PointConstraint as t}from\"../SnappingConstraint.js\";import{FeatureSnappingCandidate as n}from\"./FeatureSnappingCandidate.js\";import{PointSnappingHint as r}from\"../hints/PointSnappingHint.js\";class i extends n{constructor(n){super({...n,constraint:new t(n.coordinateHelper,n.targetPoint)})}get hints(){return[new r(this.targetPoint)]}}export{i as VertexSnappingCandidate};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{EdgeSnappingCandidate as e}from\"../candidates/EdgeSnappingCandidate.js\";import{VertexSnappingCandidate as t}from\"../candidates/VertexSnappingCandidate.js\";function r(r,n){switch(r.type){case\"edge\":return new e({coordinateHelper:n,edgeStart:n.fromPoint(r.start),edgeEnd:n.fromPoint(r.end),targetPoint:n.fromPoint(r.target),objectId:r.objectId});case\"vertex\":return new t({coordinateHelper:n,targetPoint:n.fromPoint(r.target),objectId:r.objectId})}}export{r as convertSnappingCandidate};\n"],"sourceRoot":""}