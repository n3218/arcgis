{"version":3,"sources":["../node_modules/@arcgis/core/views/3d/layers/graphics/wosrLoader.js","../node_modules/@arcgis/core/views/3d/layers/graphics/objectResourceUtils.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/TextureAtlasLookup.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexTextureCoordinates.glsl.js","../node_modules/@arcgis/core/chunks/vec32.js","../node_modules/@arcgis/core/chunks/vec33.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateAmbientOcclusion.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/shaders/DefaultMaterialTechnique.js","../node_modules/@arcgis/core/views/3d/webgl-engine/shaders/RealisticTreeTechnique.js","../node_modules/@arcgis/core/views/3d/webgl-engine/materials/DefaultMaterial.js","../node_modules/@arcgis/core/geometry/support/buffer/math/common.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/PositionAttribute.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateAmbientLighting.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateMainLighting.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateSceneLighting.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/DecodeNormal.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/NormalAttribute.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/InstancedDoublePrecision.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Offset.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/default/DefaultMaterialAuxiliaryPasses.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/Normals.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/MixExternalColor.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/lib/WebGLDriverTest.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/DoublePrecision.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/collections/Component/Material/shader/DecodeSymbolColor.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/SymbolColor.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexPosition.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexNormal.glsl.js","../node_modules/@arcgis/core/views/webgl/testSVGPremultipliedAlpha.js","../node_modules/@arcgis/core/chunks/DefaultMaterial.glsl.js","../node_modules/@arcgis/core/chunks/RealisticTree.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/ComputeNormalTexture.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/HeaderComment.glsl.js"],"names":["y","n","getLogger","x","e","t","a","g","r","A","textureDefinitions","resource","textures","i","streamDataRequester","h","s","u","ok","value","data","o","error","w","request","details","url","v","params","topology","vertexAttributes","warn","faces","values","valueType","valuesPerElement","material","b","l","c","parse","version","I","validate","p","model","name","geometries","materialDefinitions","Map","length","M","push","size","exclusive","Uint32Array","j","texture","has","image","f","set","get","id","P","substring","lastIndexOf","transparency","alphaChannelUsage","ambient","diffuse","opacity","transparent","textureAlphaMode","U","textureAlphaCutoff","textureId","initTextureTransparent","doubleSided","cullFace","colorMixMode","externalColorMixMode","textureAlphaPremultiplied","materialParamsMixin","Object","assign","d","T","m","position","stageResources","materials","pivotOffset","boundingBox","numberOfVertices","lodThreshold","forEach","boundingInfo","getBBMin","getBBMax","images","encoding","noUnpackFlip","wrap","preMultiplyAlpha","disableTextures","Promise","resolve","then","refId","channels","all","region","$","q","fileType","cache","loadWOSR","L","N","lods","referenceBoundingBox","isEsriSymbolResource","isWosr","remove","loadGLTF","usePBR","O","meta","uri","indexOf","J","isSchematic","treeRendering","customMeta","esriTreeRendering","mrrFactors","specifiedLodIndex","K","match","Number","Array","parts","attributes","normal","color","texCoord0","tangent","textureColor","parameters","D","textureNormal","textureOcclusion","textureEmissive","textureMetallicRoughness","z","emissiveFactor","_","alphaMode","Q","alphaCutoff","doubleSidedType","vertexColors","vertexTangents","normals","castShadows","receiveSSAO","normalTextureId","occlusionTextureId","emissiveTextureId","metallicRoughnessTextureId","metallicFactor","roughnessFactor","k","F","H","indices","count","primitiveType","S","transform","typedBuffer","elementCount","E","V","R","W","G","buffer","C","B","getVec","center","radius","Math","min","setVec","extensions","add","fragment","code","include","supportsTextureAtlas","attributeTextureCoordinates","typedBufferStride","sqrt","freeze","__proto__","transformMat4","transformMat3","scale","normalize","shiftRight","dstIndex","srcIndex","copy","fill","receiveAmbientOcclusion","uniforms","shader","this","configuration","build","OITEnabled","transparencyPassType","output","viewingMode","receiveShadows","slicePlaneEnabled","sliceHighlightDisabled","sliceEnabledForVertexPrograms","symbolColor","symbolColors","vvSize","vvColor","vvInstancingEnabled","instanced","instancedColor","instancedDoublePrecision","pbrMode","hasMetalnessAndRoughnessTexture","hasEmissionTexture","hasOcclusionTexture","hasNormalTexture","hasColorTexture","useCustomDTRExponentForWater","normalType","normalsTypeDerivate","doubleSidedMode","attributeColor","screenSizePerspectiveEnabled","screenSizePerspective","verticalOffsetEnabled","verticalOffset","offsetBackfaces","doublePrecisionRequiresObfuscation","rctx","alphaDiscardMode","multipassTerrainEnabled","cullAboveGround","program","camera","projectionMatrix","setUniform2fv","nearFar","inverseViewport","setUniform1f","layerOpacity","setUniform4fv","externalColor","setUniform1i","lighting","setUniforms","setUniform3fv","shadowMap","bind","ssaoHelper","viewInverseTransposeMatrix","origin","viewMatrix","rebindTextures","setUniformMatrix4fv","bindCustomOrigin","slicePlane","blending","culling","depthTest","func","depthWrite","writeDepth","colorWrite","stencilWrite","sceneHasOcludees","stencilTest","polygonOffset","enableOffset","_occludeePipelineState","setPipeline","pipeline","arguments","prototype","supportsEdges","techniqueConfig","vertexBufferLayout","getVertexBufferLayout","instanceBufferLayout","getInstanceBufferLayout","vvColorEnabled","vvSizeEnabled","shadowMappingEnabled","ssaoEnabled","offsetTransparentBackfaces","relativeElevation","eye","inverseRotation","vec3f","vec4f","vec2f","vec4u8","mat3f","mat4f","updateParameters","_material","updateTexture","_technique","_techniqueRep","releaseAndAcquire","getTechniqueConfig","_output","setParameterValues","hasOccludees","_updateShadowState","_updateOccludeeState","bindPass","bindTextures","getPipelineState","vvSizeMinSize","vvSizeMaxSize","vvSizeOffset","vvSizeFactor","vvSizeValue","vvColorValues","vvColorColors","vvSymbolAnchor","vvSymbolRotationMatrix","createBuffer","transformation","invTranspTransformation","varyings","vertex","lightingSphericalHarmonicsOrder","Uniforms","linearDepth","int","context","svgAlwaysPremultipliesAlpha","_doublePrecisionRequiresObfuscation","colorTarget","depthStencilTarget","target","wrapMode","pixelFormat","dataType","samplingMode","width","height","createVertex","Uint16Array","geometry","type","offset","stride","normalized","Float32Array","useProgram","setUniform3f","getBoundFramebufferObject","getViewport","bindFramebuffer","setViewport","bindVAO","drawArrays","Uint8Array","readPixels","dispose","abs","ModelTransform","worldFromModel_RS","worldFromModel_TH","worldFromModel_TL","ViewProjectionTransform","worldFromView_TH","worldFromView_TL","viewFromCameraRelative_RS","projFromView","bindModelTransform","setUniformMatrix3fv","bindViewProjTransform","bindUniforms","Image","src","decode","gl","bindTexture","float"],"mappings":"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","file":"static/js/28.e1768774.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../../request.js\";import{result as t}from\"../../../../core/asyncUtils.js\";import r from\"../../../../core/Error.js\";import n from\"../../../../core/Logger.js\";import{isSome as a,unwrap as s}from\"../../../../core/maybe.js\";import{throwIfAbortError as o}from\"../../../../core/promiseUtils.js\";import{Version as i}from\"../../../../core/Version.js\";import{d as u}from\"../../../../chunks/vec3f64.js\";import{empty as l,expandWithVec3 as c}from\"../../../../geometry/support/aaBoundingBox.js\";import{requestImage as p}from\"../../../../support/requestImageUtils.js\";import{Geometry as m}from\"../../webgl-engine/lib/Geometry.js\";import{Texture as f}from\"../../webgl-engine/lib/Texture.js\";import{DefaultMaterial as d}from\"../../webgl-engine/materials/DefaultMaterial.js\";const y=n.getLogger(\"esri.views.3d.layers.graphics.objectResourceUtils\");async function x(e,t){const r=await g(e,t);return{resource:r,textures:await A(r.textureDefinitions,t)}}async function g(r,n){const i=a(n)&&n.streamDataRequester;if(i)return h(r,i,n);const u=await t(e(r,s(n)));if(!0===u.ok)return u.value.data;o(u.error),w(u.error)}async function h(e,r,n){const a=await t(r.request(e,\"json\",n));if(!0===a.ok)return a.value;o(a.error),w(a.error.details.url)}function w(e){throw new r(\"\",`Request for object resource failed: ${e}`)}function v(e){const t=e.params,r=t.topology;let n=!0;switch(t.vertexAttributes||(y.warn(\"Geometry must specify vertex attributes\"),n=!1),t.topology){case\"PerAttributeArray\":break;case\"Indexed\":case null:case void 0:{const e=t.faces;if(e){if(t.vertexAttributes)for(const r in t.vertexAttributes){const t=e[r];t&&t.values?(null!=t.valueType&&\"UInt32\"!==t.valueType&&(y.warn(`Unsupported indexed geometry indices type '${t.valueType}', only UInt32 is currently supported`),n=!1),null!=t.valuesPerElement&&1!==t.valuesPerElement&&(y.warn(`Unsupported indexed geometry values per element '${t.valuesPerElement}', only 1 is currently supported`),n=!1)):(y.warn(`Indexed geometry does not specify face indices for '${r}' attribute`),n=!1)}}else y.warn(\"Indexed geometries must specify faces\"),n=!1;break}default:y.warn(`Unsupported topology '${r}'`),n=!1}e.params.material||(y.warn(\"Geometry requires material\"),n=!1);const a=e.params.vertexAttributes;for(const s in a){a[s].values||(y.warn(\"Geometries with externally defined attributes are not yet supported\"),n=!1)}return n}function b(e,t){const r=[],n=[],s=[],o=[],l=e.resource,c=i.parse(l.version||\"1.0\",\"wosr\");I.validate(c);const p=l.model.name,y=l.model.geometries,x=l.materialDefinitions,g=e.textures;let h=0;const w=new Map;for(let i=0;i<y.length;i++){const e=y[i];if(!v(e))continue;const l=M(e),c=e.params.vertexAttributes,p=[];for(const t in c){const e=c[t],r=e.values;p.push([t,{data:r,size:e.valuesPerElement,exclusive:!0}])}const b=[];if(\"PerAttributeArray\"!==e.params.topology){const t=e.params.faces;for(const e in t)b.push([e,new Uint32Array(t[e].values)])}const j=g&&g[l.texture];if(j&&!w.has(l.texture)){const{image:e,params:t}=j,r=new f(e,t);o.push(r),w.set(l.texture,r)}const A=w.get(l.texture),I=A?A.id:void 0;let P=s[l.material]?s[l.material][l.texture]:null;if(!P){const e=x[l.material.substring(l.material.lastIndexOf(\"/\")+1)].params;1===e.transparency&&(e.transparency=0);const r=j&&j.alphaChannelUsage,n=e.transparency>0||\"transparency\"===r||\"maskAndTransparency\"===r,o={ambient:u(e.diffuse),diffuse:u(e.diffuse),opacity:1-(e.transparency||0),transparent:n,textureAlphaMode:j?U(j.alphaChannelUsage):void 0,textureAlphaCutoff:.33,textureId:I,initTextureTransparent:!0,doubleSided:!0,cullFace:0,colorMixMode:e.externalColorMixMode||\"tint\",textureAlphaPremultiplied:!0};a(t)&&t.materialParamsMixin&&Object.assign(o,t.materialParamsMixin),P=new d(o),s[l.material]||(s[l.material]={}),s[l.material][l.texture]=P}n.push(P);const T=new m(p,b);h+=b.position?b.position.length:0,r.push(T)}return{name:p,stageResources:{textures:o,materials:n,geometries:r},pivotOffset:l.model.pivotOffset,boundingBox:j(r),numberOfVertices:h,lodThreshold:null}}function j(e){const t=l();return e.forEach((e=>{const r=e.boundingInfo;a(r)&&(c(t,r.getBBMin()),c(t,r.getBBMax()))})),t}async function A(e,t){const r=[];for(const o in e){const n=e[o],s=n.images[0].data;if(!s){y.warn(\"Externally referenced texture data is not yet supported\");continue}const i=n.encoding+\";base64,\"+s,u=\"/textureDefinitions/\"+o,l={noUnpackFlip:!0,wrap:{s:10497,t:10497},preMultiplyAlpha:!0},c=a(t)&&t.disableTextures?Promise.resolve(null):p(i,t);r.push(c.then((e=>({refId:u,image:e,params:l,alphaChannelUsage:\"rgba\"===n.channels?n.alphaChannelUsage||\"transparency\":\"none\"}))))}const n=await Promise.all(r),s={};for(const a of n)s[a.refId]=a;return s}function U(e){switch(e){case\"mask\":return 2;case\"maskAndTransparency\":return 3;case\"none\":return 1;case\"transparency\":default:return 0}}function M(e){const t=e.params;return{id:1,material:t.material,texture:t.texture,region:t.texture}}const I=new i(1,2,\"wosr\");export{A as createTextureResources,x as load,b as processLoadResult};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{adjustStaticAGOUrl as e}from\"../../../../core/devEnvironmentUtils.js\";import{get as t,isSome as r,isNone as s}from\"../../../../core/maybe.js\";import{a as o}from\"../../../../chunks/mat3.js\";import{c as i}from\"../../../../chunks/mat3f64.js\";import{a}from\"../../../../chunks/mat4.js\";import{c as u}from\"../../../../chunks/mat4f64.js\";import{m as n,f as l,E as c,l as m,n as d,e as f}from\"../../../../chunks/vec3.js\";import{c as p}from\"../../../../chunks/vec3f64.js\";import{empty as x,expandWithVec3 as g}from\"../../../../geometry/support/aaBoundingBox.js\";import{BufferViewVec3f as h,BufferViewVec4f as b,BufferViewVec2f as v,BufferViewVec4u8 as R,BufferViewVec4u16 as y,BufferViewVec3u8 as M,BufferViewVec3u16 as B}from\"../../../../geometry/support/buffer/BufferView.js\";import{t as w,a as j,s as C}from\"../../../../chunks/vec32.js\";import{t as E,s as T}from\"../../../../chunks/vec42.js\";import{createBuffer as S}from\"../../../../geometry/support/buffer/utils.js\";import{DefaultLoadingContext as A}from\"../../glTF/DefaultLoadingContext.js\";import{load as O}from\"../../glTF/loader.js\";import{triangleFanToTriangles as F,triangleStripToTriangles as I,trianglesToTriangles as k}from\"../../glTF/internal/indexUtils.js\";import{load as L,processLoadResult as N}from\"./wosrLoader.js\";import{Geometry as P}from\"../../webgl-engine/lib/Geometry.js\";import{Texture as D}from\"../../webgl-engine/lib/Texture.js\";import{DefaultMaterial as _}from\"../../webgl-engine/materials/DefaultMaterial.js\";import{COLOR_GAMMA as z}from\"../../webgl-engine/materials/DefaultMaterial_COLOR_GAMMA.js\";import{n as V}from\"../../../../chunks/vec22.js\";import{c as W,f as G}from\"../../../../chunks/vec43.js\";import{c as U}from\"../../../../chunks/vec33.js\";async function $(s,o){const i=q(e(s));if(\"wosr\"===i.fileType){const e=await(o.cache?o.cache.loadWOSR(i.url,o):L(i.url,o)),t=N(e,o);return{lods:[t],referenceBoundingBox:t.boundingBox,isEsriSymbolResource:!1,isWosr:!0,remove:e.remove}}const a=await(o.cache?o.cache.loadGLTF(i.url,o,o.usePBR):O(new A(o.streamDataRequester),i.url,o,o.usePBR)),u=t(a.model.meta,\"ESRI_proxyEllipsoid\");a.meta.isEsriSymbolResource&&r(u)&&-1!==a.meta.uri.indexOf(\"/RealisticTrees/\")&&J(a,u);const n=a.meta.isEsriSymbolResource?{usePBR:o.usePBR,isSchematic:!1,treeRendering:a.customMeta.esriTreeRendering,mrrFactors:[0,1,.2]}:{usePBR:o.usePBR,isSchematic:!1,mrrFactors:[0,1,.5]},l={...o.materialParamsMixin,treeRendering:a.customMeta.esriTreeRendering};if(null!=i.specifiedLodIndex){const e=K(a,n,l,i.specifiedLodIndex);let t=e[0].boundingBox;if(0!==i.specifiedLodIndex){t=K(a,n,l,0)[0].boundingBox}return{lods:e,referenceBoundingBox:t,isEsriSymbolResource:a.meta.isEsriSymbolResource,isWosr:!1,remove:a.remove}}const c=K(a,n,l);return{lods:c,referenceBoundingBox:c[0].boundingBox,isEsriSymbolResource:a.meta.isEsriSymbolResource,isWosr:!1,remove:a.remove}}function q(e){const t=e.match(/(.*\\.(gltf|glb))(\\?lod=([0-9]+))?$/);if(t)return{fileType:\"gltf\",url:t[1],specifiedLodIndex:null!=t[4]?Number(t[4]):null};return e.match(/(.*\\.(json|json\\.gz))$/)?{fileType:\"wosr\",url:e,specifiedLodIndex:null}:{fileType:\"unknown\",url:e,specifiedLodIndex:null}}function K(e,t,s,a){const u=e.model,n=i(),l=new Array,c=new Map,m=new Map;return u.lods.forEach(((e,i)=>{if(void 0!==a&&i!==a)return;const d={name:e.name,stageResources:{textures:new Array,materials:new Array,geometries:new Array},lodThreshold:r(e.lodThreshold)?e.lodThreshold:null,pivotOffset:[0,0,0],numberOfVertices:0,boundingBox:x()};l.push(d),e.parts.forEach((e=>{const i=e.material+(e.attributes.normal?\"_normal\":\"\")+(e.attributes.color?\"_color\":\"\")+(e.attributes.texCoord0?\"_texCoord0\":\"\")+(e.attributes.tangent?\"_tangent\":\"\"),a=u.materials.get(e.material),l=r(e.attributes.texCoord0),f=r(e.attributes.normal);if(!c.has(i)){if(l){if(r(a.textureColor)&&!m.has(a.textureColor)){const e=u.textures.get(a.textureColor),t={...e.parameters,preMultiplyAlpha:!0};m.set(a.textureColor,new D(e.data,t))}if(r(a.textureNormal)&&!m.has(a.textureNormal)){const e=u.textures.get(a.textureNormal),t={...e.parameters,preMultiplyAlpha:!0};m.set(a.textureNormal,new D(e.data,t))}if(r(a.textureOcclusion)&&!m.has(a.textureOcclusion)){const e=u.textures.get(a.textureOcclusion),t={...e.parameters,preMultiplyAlpha:!0};m.set(a.textureOcclusion,new D(e.data,t))}if(r(a.textureEmissive)&&!m.has(a.textureEmissive)){const e=u.textures.get(a.textureEmissive),t={...e.parameters,preMultiplyAlpha:!0};m.set(a.textureEmissive,new D(e.data,t))}if(r(a.textureMetallicRoughness)&&!m.has(a.textureMetallicRoughness)){const e=u.textures.get(a.textureMetallicRoughness),t={...e.parameters,preMultiplyAlpha:!0};m.set(a.textureMetallicRoughness,new D(e.data,t))}}const o=a.color[0]**(1/z),n=a.color[1]**(1/z),d=a.color[2]**(1/z),p=a.emissiveFactor[0]**(1/z),x=a.emissiveFactor[1]**(1/z),g=a.emissiveFactor[2]**(1/z);c.set(i,new _({...t,transparent:\"BLEND\"===a.alphaMode,textureAlphaMode:Q(a.alphaMode),textureAlphaCutoff:a.alphaCutoff,diffuse:[o,n,d],ambient:[o,n,d],opacity:a.opacity,doubleSided:a.doubleSided,doubleSidedType:\"winding-order\",cullFace:a.doubleSided?0:2,vertexColors:!!e.attributes.color,vertexTangents:!!e.attributes.tangent,normals:f?\"default\":\"screenDerivative\",castShadows:!0,receiveSSAO:!0,textureId:r(a.textureColor)&&l?m.get(a.textureColor).id:void 0,colorMixMode:a.colorMixMode,normalTextureId:r(a.textureNormal)&&l?m.get(a.textureNormal).id:void 0,textureAlphaPremultiplied:!0,occlusionTextureId:r(a.textureOcclusion)&&l?m.get(a.textureOcclusion).id:void 0,emissiveTextureId:r(a.textureEmissive)&&l?m.get(a.textureEmissive).id:void 0,metallicRoughnessTextureId:r(a.textureMetallicRoughness)&&l?m.get(a.textureMetallicRoughness).id:void 0,emissiveFactor:[p,x,g],mrrFactors:[a.metallicFactor,a.roughnessFactor,t.mrrFactors[2]],isSchematic:!1,...s}))}const p=H(e.indices||e.attributes.position.count,e.primitiveType),x=e.attributes.position.count,A=S(h,x);w(A,e.attributes.position,e.transform);const O=[[\"position\",{data:A.typedBuffer,size:A.elementCount,exclusive:!0}]],F=[[\"position\",p]];if(r(e.attributes.normal)){const t=S(h,x);o(n,e.transform),j(t,e.attributes.normal,n),O.push([\"normal\",{data:t.typedBuffer,size:t.elementCount,exclusive:!0}]),F.push([\"normal\",p])}if(r(e.attributes.tangent)){const t=S(b,x);o(n,e.transform),E(t,e.attributes.tangent,n),O.push([\"tangent\",{data:t.typedBuffer,size:t.elementCount,exclusive:!0}]),F.push([\"tangent\",p])}if(r(e.attributes.texCoord0)){const t=S(v,x);V(t,e.attributes.texCoord0),O.push([\"uv0\",{data:t.typedBuffer,size:t.elementCount,exclusive:!0}]),F.push([\"uv0\",p])}if(r(e.attributes.color)){const t=S(R,x);if(4===e.attributes.color.elementCount)e.attributes.color instanceof b?T(t,e.attributes.color,255):e.attributes.color instanceof R?W(t,e.attributes.color):e.attributes.color instanceof y&&T(t,e.attributes.color,1/256);else{G(t,255,255,255,255);const r=new M(t.buffer,0,4);e.attributes.color instanceof h?C(r,e.attributes.color,255):e.attributes.color instanceof M?U(r,e.attributes.color):e.attributes.color instanceof B&&C(r,e.attributes.color,1/256)}O.push([\"color\",{data:t.typedBuffer,size:t.elementCount,exclusive:!0}]),F.push([\"color\",p])}const I=new P(O,F);d.stageResources.geometries.push(I),d.stageResources.materials.push(c.get(i)),l&&(r(a.textureColor)&&d.stageResources.textures.push(m.get(a.textureColor)),r(a.textureNormal)&&d.stageResources.textures.push(m.get(a.textureNormal)),r(a.textureOcclusion)&&d.stageResources.textures.push(m.get(a.textureOcclusion)),r(a.textureEmissive)&&d.stageResources.textures.push(m.get(a.textureEmissive)),r(a.textureMetallicRoughness)&&d.stageResources.textures.push(m.get(a.textureMetallicRoughness))),d.numberOfVertices+=x;const k=I.boundingInfo;r(k)&&(g(d.boundingBox,k.getBBMin()),g(d.boundingBox,k.getBBMax()))}))})),l}function Q(e){switch(e){case\"BLEND\":return 0;case\"MASK\":return 2;case\"OPAQUE\":return 1;default:return 0}}function H(e,t){switch(t){case 4:return k(e);case 5:return I(e);case 6:return F(e)}}function J(e,t){for(let r=0;r<e.model.lods.length;++r){const o=e.model.lods[r];e.customMeta.esriTreeRendering=!0;for(const i of o.parts){const o=i.attributes.normal;if(s(o))return;const x=i.attributes.position,g=x.count,b=p(),v=p(),y=p(),M=S(R,g),B=S(h,g),w=a(u(),i.transform);for(let s=0;s<g;s++){x.getVec(s,v),o.getVec(s,b),n(v,v,i.transform),l(y,v,t.center),c(y,y,t.radius);const a=y[2],u=m(y),p=Math.min(.45+.55*u*u,1);c(y,y,t.radius),n(y,y,w),d(y,y),r+1!==e.model.lods.length&&e.model.lods.length>1&&f(y,y,b,a>-1?.2:Math.min(-4*a-3.8,1)),B.setVec(s,y),M.set(s,0,255*p),M.set(s,1,255*p),M.set(s,2,255*p),M.set(s,3,255)}i.attributes.normal=B,i.attributes.color=M}}}export{$ as fetch,K as gltfToEngineResources,q as parseUrl};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{glsl as e}from\"../../shaderModules/interfaces.js\";function t(t){t.extensions.add(\"GL_EXT_shader_texture_lod\"),t.extensions.add(\"GL_OES_standard_derivatives\"),t.fragment.code.add(e`#ifndef GL_EXT_shader_texture_lod\nfloat calcMipMapLevel(const vec2 ddx, const vec2 ddy) {\nfloat deltaMaxSqr = max(dot(ddx, ddx), dot(ddy, ddy));\nreturn max(0.0, 0.5 * log2(deltaMaxSqr));\n}\n#endif\nvec4 textureAtlasLookup(sampler2D texture, vec2 textureSize, vec2 textureCoordinates, vec4 atlasRegion) {\nvec2 atlasScale = atlasRegion.zw - atlasRegion.xy;\nvec2 uvAtlas = fract(textureCoordinates) * atlasScale + atlasRegion.xy;\nfloat maxdUV = 0.125;\nvec2 dUVdx = clamp(dFdx(textureCoordinates), -maxdUV, maxdUV) * atlasScale;\nvec2 dUVdy = clamp(dFdy(textureCoordinates), -maxdUV, maxdUV) * atlasScale;\n#ifdef GL_EXT_shader_texture_lod\nreturn texture2DGradEXT(texture, uvAtlas, dUVdx, dUVdy);\n#else\nvec2 dUVdxAuto = dFdx(uvAtlas);\nvec2 dUVdyAuto = dFdy(uvAtlas);\nfloat mipMapLevel = calcMipMapLevel(dUVdx * textureSize, dUVdy * textureSize);\nfloat autoMipMapLevel = calcMipMapLevel(dUVdxAuto * textureSize, dUVdyAuto * textureSize);\nreturn texture2D(texture, uvAtlas, mipMapLevel - autoMipMapLevel);\n#endif\n}`)}export{t as TextureAtlasLookup};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{TextureCoordinateAttribute as e}from\"./TextureCoordinateAttribute.glsl.js\";import{TextureAtlasLookup as t}from\"../util/TextureAtlasLookup.glsl.js\";import{glsl as r}from\"../../shaderModules/interfaces.js\";function u(u,a){u.include(e,a),u.fragment.code.add(r`\n  struct TextureLookupParameter {\n    vec2 uv;\n    ${a.supportsTextureAtlas?\"vec2 size;\":\"\"}\n  } vtc;\n  `),1===a.attributeTextureCoordinates&&u.fragment.code.add(r`vec4 textureLookup(sampler2D tex, TextureLookupParameter params) {\nreturn texture2D(tex, params.uv);\n}`),2===a.attributeTextureCoordinates&&(u.include(t),u.fragment.code.add(r`vec4 textureLookup(sampler2D tex, TextureLookupParameter params) {\nreturn textureAtlasLookup(tex, params.size, params.uv, vuvRegion);\n}`))}export{u as VertexTextureCoordinates};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{logger as t}from\"../geometry/support/buffer/math/common.js\";function e(e,f,r){if(e.count!==f.count)return void t.error(\"source and destination buffers need to have the same number of elements\");const o=e.count,n=r[0],u=r[1],d=r[2],s=r[4],c=r[5],i=r[6],a=r[8],p=r[9],y=r[10],B=r[12],m=r[13],h=r[14],l=e.typedBuffer,S=e.typedBufferStride,b=f.typedBuffer,v=f.typedBufferStride;for(let t=0;t<o;t++){const e=t*S,f=t*v,r=b[f],o=b[f+1],M=b[f+2];l[e]=n*r+s*o+a*M+B,l[e+1]=u*r+c*o+p*M+m,l[e+2]=d*r+i*o+y*M+h}}function f(e,f,r){if(e.count!==f.count)return void t.error(\"source and destination buffers need to have the same number of elements\");const o=e.count,n=r[0],u=r[1],d=r[2],s=r[3],c=r[4],i=r[5],a=r[6],p=r[7],y=r[8],B=e.typedBuffer,m=e.typedBufferStride,h=f.typedBuffer,l=f.typedBufferStride;for(let t=0;t<o;t++){const e=t*m,f=t*l,r=h[f],o=h[f+1],S=h[f+2];B[e]=n*r+s*o+a*S,B[e+1]=u*r+c*o+p*S,B[e+2]=d*r+i*o+y*S}}function r(t,e,f){const r=Math.min(t.count,e.count),o=t.typedBuffer,n=t.typedBufferStride,u=e.typedBuffer,d=e.typedBufferStride;for(let s=0;s<r;s++){const t=s*n,e=s*d;o[t]=f*u[e],o[t+1]=f*u[e+1],o[t+2]=f*u[e+2]}}function o(t,e){const f=Math.min(t.count,e.count),r=t.typedBuffer,o=t.typedBufferStride,n=e.typedBuffer,u=e.typedBufferStride;for(let d=0;d<f;d++){const t=d*o,e=d*u,f=n[e],s=n[e+1],c=n[e+2],i=Math.sqrt(f*f+s*s+c*c);if(i>0){const e=1/i;r[t]=e*f,r[t+1]=e*s,r[t+2]=e*c}}}function n(t,e,f){const r=Math.min(t.count,e.count),o=t.typedBuffer,n=t.typedBufferStride,u=e.typedBuffer,d=e.typedBufferStride;for(let s=0;s<r;s++){const t=s*n,e=s*d;o[t]=u[e]>>f,o[t+1]=u[e+1]>>f,o[t+2]=u[e+2]>>f}}var u=Object.freeze({__proto__:null,transformMat4:e,transformMat3:f,scale:r,normalize:o,shiftRight:n});export{f as a,n as b,o as n,r as s,e as t,u as v};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nfunction e(e,t,n){const d=e.typedBuffer,f=e.typedBufferStride,r=t.typedBuffer,u=t.typedBufferStride,l=n?n.count:t.count;let o=(n&&n.dstIndex?n.dstIndex:0)*f,c=(n&&n.srcIndex?n.srcIndex:0)*u;for(let s=0;s<l;++s)d[o]=r[c],d[o+1]=r[c+1],d[o+2]=r[c+2],o+=f,c+=u}function t(e,t,n,d,f){var r,u;const l=e.typedBuffer,o=e.typedBufferStride,c=null!=(r=null==f?void 0:f.count)?r:e.count;let s=(null!=(u=null==f?void 0:f.dstIndex)?u:0)*o;for(let p=0;p<c;++p)l[s]=t,l[s+1]=n,l[s+2]=d,s+=o}var n=Object.freeze({__proto__:null,copy:e,fill:t});export{e as c,t as f,n as v};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{glsl as e}from\"../../shaderModules/interfaces.js\";function o(o,t){const r=o.fragment;t.receiveAmbientOcclusion?(r.uniforms.add(\"ssaoTex\",\"sampler2D\"),r.uniforms.add(\"viewportPixelSz\",\"vec4\"),r.code.add(e`float evaluateAmbientOcclusion() {\nreturn 1.0 - texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\n}\nfloat evaluateAmbientOcclusionInverse() {\nfloat ssao = texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\nreturn viewportPixelSz.z < 0.0 ? 1.0 : ssao;\n}`)):r.code.add(e`float evaluateAmbientOcclusion() { return 0.0; }\nfloat evaluateAmbientOcclusionInverse() { return 1.0; }`)}export{o as EvaluateAmbientOcclusion};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{f as t}from\"../../../../chunks/vec3f64.js\";import{bindSliceUniforms as i}from\"../core/shaderLibrary/Slice.glsl.js\";import{InstancedDoublePrecision as r}from\"../core/shaderLibrary/attributes/InstancedDoublePrecision.glsl.js\";import{bindVerticalOffsetUniforms as o}from\"../core/shaderLibrary/attributes/VerticalOffset.glsl.js\";import{bindOutputHighlight as s}from\"../core/shaderLibrary/output/OutputHighlight.glsl.js\";import{bindMultipassTerrainTexture as a}from\"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{bindPBRUniforms as n}from\"../core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl.js\";import{bindReadShadowMapViewCustomOrigin as l}from\"../core/shaderLibrary/shading/ReadShadowMap.glsl.js\";import{bindVisualVariablesUniformsForSymbols as p}from\"../core/shaderLibrary/shading/VisualVariables.glsl.js\";import{doublePrecisionRequiresObfuscation as c}from\"../core/shaderLibrary/util/DoublePrecision.glsl.js\";import{bindProjectionMatrix as u,bindViewCustomOrigin as h,bindCameraPosition as d}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as m}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as f}from\"../core/shaderTechnique/ShaderTechnique.js\";import{ShaderTechniqueConfiguration as v,parameter as g}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{Default3D as b}from\"../lib/DefaultVertexAttributeLocations.js\";import{blendingDefault as y,OITBlending as x,OITDepthTest as T,getOITPolygonOffset as P}from\"../lib/OrderIndependentTransparency.js\";import{Program as M}from\"../lib/Program.js\";import{stencilWriteMaskOn as S,stencilToolMaskBaseParams as C,stencilBaseAllZerosParams as O}from\"../lib/StencilUtils.js\";import{colorMixModes as D,bindScreenSizePerspective as w}from\"../materials/internal/MaterialUtil.js\";import{D as j}from\"../../../../chunks/DefaultMaterial.glsl.js\";import{makePipelineState as A,cullingParams as E,defaultDepthWriteParams as U,defaultColorWriteParams as z}from\"../../../webgl/renderState.js\";class R extends f{initializeProgram(e){const t=R.shader.get(),i=this.configuration,r=t.build({OITEnabled:0===i.transparencyPassType,output:i.output,viewingMode:e.viewingMode,receiveShadows:i.receiveShadows,slicePlaneEnabled:i.slicePlaneEnabled,sliceHighlightDisabled:i.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,symbolColor:i.symbolColors,vvSize:i.vvSize,vvColor:i.vvColor,vvInstancingEnabled:!0,instanced:i.instanced,instancedColor:i.instancedColor,instancedDoublePrecision:i.instancedDoublePrecision,pbrMode:i.usePBR?i.isSchematic?2:1:0,hasMetalnessAndRoughnessTexture:i.hasMetalnessAndRoughnessTexture,hasEmissionTexture:i.hasEmissionTexture,hasOcclusionTexture:i.hasOcclusionTexture,hasNormalTexture:i.hasNormalTexture,hasColorTexture:i.hasColorTexture,receiveAmbientOcclusion:i.receiveAmbientOcclusion,useCustomDTRExponentForWater:!1,normalType:i.normalsTypeDerivate?3:0,doubleSidedMode:i.doubleSidedMode,vertexTangents:i.vertexTangents,attributeTextureCoordinates:i.hasMetalnessAndRoughnessTexture||i.hasEmissionTexture||i.hasOcclusionTexture||i.hasNormalTexture||i.hasColorTexture?1:0,textureAlphaPremultiplied:i.textureAlphaPremultiplied,attributeColor:i.vertexColors,screenSizePerspectiveEnabled:i.screenSizePerspective,verticalOffsetEnabled:i.verticalOffset,offsetBackfaces:i.offsetBackfaces,doublePrecisionRequiresObfuscation:c(e.rctx),alphaDiscardMode:i.alphaDiscardMode,supportsTextureAtlas:!1,multipassTerrainEnabled:i.multipassTerrainEnabled,cullAboveGround:i.cullAboveGround});return new M(e.rctx,r,b)}bindPass(e,t){var i,r;u(this.program,t.camera.projectionMatrix);const l=this.configuration.output;(1===this.configuration.output||t.multipassTerrainEnabled||3===l)&&this.program.setUniform2fv(\"cameraNearFar\",t.camera.nearFar),t.multipassTerrainEnabled&&(this.program.setUniform2fv(\"inverseViewport\",t.inverseViewport),a(this.program,t)),7===l&&(this.program.setUniform1f(\"opacity\",e.opacity),this.program.setUniform1f(\"layerOpacity\",e.layerOpacity),this.program.setUniform4fv(\"externalColor\",e.externalColor),this.program.setUniform1i(\"colorMixMode\",D[e.colorMixMode])),0===l?(t.lighting.setUniforms(this.program,!1),this.program.setUniform3fv(\"ambient\",e.ambient),this.program.setUniform3fv(\"diffuse\",e.diffuse),this.program.setUniform4fv(\"externalColor\",e.externalColor),this.program.setUniform1i(\"colorMixMode\",D[e.colorMixMode]),this.program.setUniform1f(\"opacity\",e.opacity),this.program.setUniform1f(\"layerOpacity\",e.layerOpacity),this.configuration.usePBR&&n(this.program,e,this.configuration.isSchematic)):4===l&&s(this.program,t),p(this.program,e),o(this.program,e,t),w(e.screenSizePerspective,this.program,\"screenSizePerspectiveAlignment\"),2!==e.textureAlphaMode&&3!==e.textureAlphaMode||this.program.setUniform1f(\"textureAlphaCutoff\",e.textureAlphaCutoff),null==(i=t.shadowMap)||i.bind(this.program),null==(r=t.ssaoHelper)||r.bind(this.program)}bindDraw(e){const o=this.configuration.instancedDoublePrecision?t(e.camera.viewInverseTransposeMatrix[3],e.camera.viewInverseTransposeMatrix[7],e.camera.viewInverseTransposeMatrix[11]):e.origin;h(this.program,o,e.camera.viewMatrix),this.program.rebindTextures(),(0===this.configuration.output||7===this.configuration.output||1===this.configuration.output&&this.configuration.screenSizePerspective||2===this.configuration.output&&this.configuration.screenSizePerspective||4===this.configuration.output&&this.configuration.screenSizePerspective)&&d(this.program,o,e.camera.viewInverseTransposeMatrix),2===this.configuration.output&&this.program.setUniformMatrix4fv(\"viewNormal\",e.camera.viewInverseTransposeMatrix),this.configuration.instancedDoublePrecision&&r.bindCustomOrigin(this.program,o),i(this.program,this.configuration,e.slicePlane,o),0===this.configuration.output&&l(this.program,e,o)}setPipeline(e,t){const i=this.configuration,r=3===e,o=2===e;return A({blending:0!==i.output&&7!==i.output||!i.transparent?null:r?y:x(e),culling:L(i)&&E(i.cullFace),depthTest:{func:T(e)},depthWrite:r||o?i.writeDepth&&U:null,colorWrite:z,stencilWrite:i.sceneHasOcludees?S:null,stencilTest:i.sceneHasOcludees?t?C:O:null,polygonOffset:r||o?null:P(i.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this.setPipeline(this.configuration.transparencyPassType,!0),this.setPipeline(this.configuration.transparencyPassType,!1)}getPipelineState(e){return e?this._occludeePipelineState:this.pipeline}}function L(e){return e.cullFace?0!==e.cullFace:!e.slicePlaneEnabled&&(!e.transparent&&!e.doubleSidedMode)}R.shader=new m(j,(()=>import(\"./DefaultMaterial.glsl.js\")));class H extends v{constructor(){super(...arguments),this.output=0,this.alphaDiscardMode=1,this.doubleSidedMode=0,this.isSchematic=!1,this.vertexColors=!1,this.offsetBackfaces=!1,this.symbolColors=!1,this.vvSize=!1,this.vvColor=!1,this.verticalOffset=!1,this.receiveShadows=!1,this.slicePlaneEnabled=!1,this.sliceHighlightDisabled=!1,this.receiveAmbientOcclusion=!1,this.screenSizePerspective=!1,this.textureAlphaPremultiplied=!1,this.hasColorTexture=!1,this.usePBR=!1,this.hasMetalnessAndRoughnessTexture=!1,this.hasEmissionTexture=!1,this.hasOcclusionTexture=!1,this.hasNormalTexture=!1,this.instanced=!1,this.instancedColor=!1,this.instancedDoublePrecision=!1,this.vertexTangents=!1,this.normalsTypeDerivate=!1,this.writeDepth=!0,this.sceneHasOcludees=!1,this.transparent=!1,this.enableOffset=!0,this.cullFace=0,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!1}}e([g({count:8})],H.prototype,\"output\",void 0),e([g({count:4})],H.prototype,\"alphaDiscardMode\",void 0),e([g({count:3})],H.prototype,\"doubleSidedMode\",void 0),e([g()],H.prototype,\"isSchematic\",void 0),e([g()],H.prototype,\"vertexColors\",void 0),e([g()],H.prototype,\"offsetBackfaces\",void 0),e([g()],H.prototype,\"symbolColors\",void 0),e([g()],H.prototype,\"vvSize\",void 0),e([g()],H.prototype,\"vvColor\",void 0),e([g()],H.prototype,\"verticalOffset\",void 0),e([g()],H.prototype,\"receiveShadows\",void 0),e([g()],H.prototype,\"slicePlaneEnabled\",void 0),e([g()],H.prototype,\"sliceHighlightDisabled\",void 0),e([g()],H.prototype,\"receiveAmbientOcclusion\",void 0),e([g()],H.prototype,\"screenSizePerspective\",void 0),e([g()],H.prototype,\"textureAlphaPremultiplied\",void 0),e([g()],H.prototype,\"hasColorTexture\",void 0),e([g()],H.prototype,\"usePBR\",void 0),e([g()],H.prototype,\"hasMetalnessAndRoughnessTexture\",void 0),e([g()],H.prototype,\"hasEmissionTexture\",void 0),e([g()],H.prototype,\"hasOcclusionTexture\",void 0),e([g()],H.prototype,\"hasNormalTexture\",void 0),e([g()],H.prototype,\"instanced\",void 0),e([g()],H.prototype,\"instancedColor\",void 0),e([g()],H.prototype,\"instancedDoublePrecision\",void 0),e([g()],H.prototype,\"vertexTangents\",void 0),e([g()],H.prototype,\"normalsTypeDerivate\",void 0),e([g()],H.prototype,\"writeDepth\",void 0),e([g()],H.prototype,\"sceneHasOcludees\",void 0),e([g()],H.prototype,\"transparent\",void 0),e([g()],H.prototype,\"enableOffset\",void 0),e([g({count:3})],H.prototype,\"cullFace\",void 0),e([g({count:4})],H.prototype,\"transparencyPassType\",void 0),e([g()],H.prototype,\"multipassTerrainEnabled\",void 0),e([g()],H.prototype,\"cullAboveGround\",void 0);export{R as DefaultMaterialTechnique,H as DefaultMaterialTechniqueConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{R as e}from\"../../../../chunks/RealisticTree.glsl.js\";import{doublePrecisionRequiresObfuscation as r}from\"../core/shaderLibrary/util/DoublePrecision.glsl.js\";import{ReloadableShaderModule as s}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{Default3D as i}from\"../lib/DefaultVertexAttributeLocations.js\";import{Program as o}from\"../lib/Program.js\";import{DefaultMaterialTechnique as t}from\"./DefaultMaterialTechnique.js\";class a extends t{initializeProgram(e){const s=a.shader.get(),t=this.configuration,l=s.build({OITEnabled:0===t.transparencyPassType,output:t.output,viewingMode:e.viewingMode,receiveShadows:t.receiveShadows,slicePlaneEnabled:t.slicePlaneEnabled,sliceHighlightDisabled:t.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,symbolColor:t.symbolColors,vvSize:t.vvSize,vvColor:t.vvColor,vvInstancingEnabled:!0,instanced:t.instanced,instancedColor:t.instancedColor,instancedDoublePrecision:t.instancedDoublePrecision,pbrMode:t.usePBR?1:0,hasMetalnessAndRoughnessTexture:!1,hasEmissionTexture:!1,hasOcclusionTexture:!1,hasNormalTexture:!1,hasColorTexture:t.hasColorTexture,receiveAmbientOcclusion:t.receiveAmbientOcclusion,useCustomDTRExponentForWater:!1,normalType:0,doubleSidedMode:2,vertexTangents:!1,attributeTextureCoordinates:t.hasColorTexture?1:0,textureAlphaPremultiplied:t.textureAlphaPremultiplied,attributeColor:t.vertexColors,screenSizePerspectiveEnabled:t.screenSizePerspective,verticalOffsetEnabled:t.verticalOffset,offsetBackfaces:t.offsetBackfaces,doublePrecisionRequiresObfuscation:r(e.rctx),alphaDiscardMode:t.alphaDiscardMode,supportsTextureAtlas:!1,multipassTerrainEnabled:t.multipassTerrainEnabled,cullAboveGround:t.cullAboveGround});return new o(e.rctx,l,i)}}a.shader=new s(e,(()=>import(\"../core/shaderLibrary/default/RealisticTree.glsl.js\")));export{a as RealisticTreeTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{c as e}from\"../../../../chunks/mat3f64.js\";import{s as t,g as i,n as s,f as a,l as r,a as n,d as o,t as l}from\"../../../../chunks/vec3.js\";import{c as u,f as c}from\"../../../../chunks/vec3f64.js\";import{newLayout as h}from\"../../support/buffer/InterleavedLayout.js\";import{defaultMaskAlphaCutoff as d}from\"../core/shaderLibrary/util/AlphaDiscard.glsl.js\";import p from\"../lib/GLMaterialTexture.js\";import{Material as m,materialParametersDefaults as f}from\"../lib/Material.js\";import{OITPolygonOffsetLimit as v}from\"../lib/OrderIndependentTransparency.js\";import{getVerticalOffsetObject3D as g}from\"../lib/verticalOffsetUtils.js\";import{writeDefaultAttributes as C}from\"./internal/bufferWriterUtils.js\";import{verticalOffsetAtDistance as b,intersectTriangleGeometry as x}from\"./internal/MaterialUtil.js\";import{DefaultMaterialTechniqueConfiguration as q,DefaultMaterialTechnique as S}from\"../shaders/DefaultMaterialTechnique.js\";import{RealisticTreeTechnique as T}from\"../shaders/RealisticTreeTechnique.js\";class y extends m{constructor(e){super(e,O),this.supportsEdges=!0,this.techniqueConfig=new q,this.vertexBufferLayout=y.getVertexBufferLayout(this.params),this.instanceBufferLayout=e.instanced?y.getInstanceBufferLayout(this.params):null}isVisibleInPass(e){return 4!==e&&6!==e&&7!==e||this.params.castShadows}isVisible(){const e=this.params;if(!super.isVisible()||0===e.layerOpacity)return!1;const t=e.instanced,i=e.vertexColors,s=e.symbolColors,a=!!t&&t.indexOf(\"color\")>-1,r=e.vvColorEnabled,n=\"replace\"===e.colorMixMode,o=e.opacity>0,l=e.externalColor&&e.externalColor[3]>0;return i&&(a||r||s)?!!n||o:i?n?l:o:a||r||s?!!n||o:n?l:o}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.hasNormalTexture=!!this.params.normalTextureId,this.techniqueConfig.hasColorTexture=!!this.params.textureId,this.techniqueConfig.vertexTangents=this.params.vertexTangents,this.techniqueConfig.instanced=!!this.params.instanced,this.techniqueConfig.instancedDoublePrecision=this.params.instancedDoublePrecision,this.techniqueConfig.vvSize=this.params.vvSizeEnabled,this.techniqueConfig.verticalOffset=null!==this.params.verticalOffset,this.techniqueConfig.screenSizePerspective=null!==this.params.screenSizePerspective,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.sliceHighlightDisabled=this.params.sliceHighlightDisabled,this.techniqueConfig.alphaDiscardMode=this.params.textureAlphaMode,this.techniqueConfig.normalsTypeDerivate=\"screenDerivative\"===this.params.normals,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig.cullFace=this.params.slicePlaneEnabled?0:this.params.cullFace,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,0!==e&&7!==e||(this.techniqueConfig.vertexColors=this.params.vertexColors,this.techniqueConfig.symbolColors=this.params.symbolColors,this.params.treeRendering?this.techniqueConfig.doubleSidedMode=2:this.techniqueConfig.doubleSidedMode=this.params.doubleSided&&\"normal\"===this.params.doubleSidedType?1:this.params.doubleSided&&\"winding-order\"===this.params.doubleSidedType?2:0,this.techniqueConfig.instancedColor=!!this.params.instanced&&this.params.instanced.indexOf(\"color\")>-1,this.techniqueConfig.receiveShadows=this.params.receiveShadows&&this.params.shadowMappingEnabled,this.techniqueConfig.receiveAmbientOcclusion=!(!t||!t.ssaoEnabled)&&this.params.receiveSSAO,this.techniqueConfig.vvColor=this.params.vvColorEnabled,this.techniqueConfig.textureAlphaPremultiplied=!!this.params.textureAlphaPremultiplied,this.techniqueConfig.usePBR=this.params.usePBR,this.techniqueConfig.hasMetalnessAndRoughnessTexture=!!this.params.metallicRoughnessTextureId,this.techniqueConfig.hasEmissionTexture=!!this.params.emissiveTextureId,this.techniqueConfig.hasOcclusionTexture=!!this.params.occlusionTextureId,this.techniqueConfig.offsetBackfaces=!(!this.params.transparent||!this.params.offsetTransparentBackfaces),this.techniqueConfig.isSchematic=this.params.usePBR&&this.params.isSchematic,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.enableOffset=!t||t.camera.relativeElevation<v),this.techniqueConfig}intersect(e,u,c,h,d,p,m){if(null!==this.params.verticalOffset){const e=h.camera;t(A,c[12],c[13],c[14]);let u=null;switch(h.viewingMode){case 1:u=s(E,A);break;case 2:u=i(E,B)}let m=0;if(null!==this.params.verticalOffset){const t=a(L,A,e.eye),i=r(t),s=n(t,t,1/i);let l=null;this.params.screenSizePerspective&&(l=o(u,s)),m+=b(e,i,this.params.verticalOffset,l,this.params.screenSizePerspective)}n(u,u,m),l(I,u,h.transform.inverseRotation),d=a(w,d,I),p=a(_,p,I)}x(e,u,h,d,p,g(h.verticalOffset),m)}getGLMaterial(e){if(0===e.output||7===e.output||1===e.output||2===e.output||3===e.output||4===e.output)return new P(e)}createBufferWriter(){return new M(this.vertexBufferLayout,this.instanceBufferLayout)}static getVertexBufferLayout(e){const t=e.textureId||e.normalTextureId||e.metallicRoughnessTextureId||e.emissiveTextureId||e.occlusionTextureId,i=h().vec3f(\"position\").vec3f(\"normal\");return e.vertexTangents&&i.vec4f(\"tangent\"),t&&i.vec2f(\"uv0\"),e.vertexColors&&i.vec4u8(\"color\"),e.symbolColors&&i.vec4u8(\"symbolColor\"),i}static getInstanceBufferLayout(e){let t=h();return t=e.instancedDoublePrecision?t.vec3f(\"modelOriginHi\").vec3f(\"modelOriginLo\").mat3f(\"model\").mat3f(\"modelNormal\"):t.mat4f(\"model\").mat4f(\"modelNormal\"),e.instanced&&e.instanced.indexOf(\"color\")>-1&&(t=t.vec4f(\"instanceColor\")),e.instanced&&e.instanced.indexOf(\"featureAttribute\")>-1&&(t=t.vec4f(\"instanceFeatureAttribute\")),t}}class P extends p{constructor(e){const t=e.material;super({...e,...t.params}),this.updateParameters()}updateParameters(e){const t=this._material.params;this.updateTexture(t.textureId),this._technique=this._techniqueRep.releaseAndAcquire(t.treeRendering?T:S,this._material.getTechniqueConfig(this._output,e),this._technique)}selectPipelines(){}_updateShadowState(e){e.shadowMappingEnabled!==this._material.params.shadowMappingEnabled&&this._material.setParameterValues({shadowMappingEnabled:e.shadowMappingEnabled})}_updateOccludeeState(e){e.hasOccludees!==this._material.params.sceneHasOcludees&&this._material.setParameterValues({sceneHasOcludees:e.hasOccludees})}ensureParameters(e){0!==this._output&&7!==this._output||(this._updateShadowState(e),this._updateOccludeeState(e)),this.updateParameters(e)}bind(e){this._technique.bindPass(this._material.params,e),this.bindTextures(this._technique.program)}beginSlot(e){return e===(this._material.params.transparent?this._material.params.writeDepth?5:8:3)}getPipelineState(e,t){return this._technique.getPipelineState(t)}}const O={textureId:void 0,initTextureTransparent:!1,isSchematic:!1,usePBR:!1,normalTextureId:void 0,vertexTangents:!1,occlusionTextureId:void 0,emissiveTextureId:void 0,metallicRoughnessTextureId:void 0,emissiveFactor:[0,0,0],mrrFactors:[0,1,.5],ambient:[.2,.2,.2],diffuse:[.8,.8,.8],externalColor:[1,1,1,1],colorMixMode:\"multiply\",opacity:1,layerOpacity:1,vertexColors:!1,symbolColors:!1,doubleSided:!1,doubleSidedType:\"normal\",cullFace:2,instanced:void 0,instancedDoublePrecision:!1,normals:\"default\",receiveSSAO:!0,receiveShadows:!0,castShadows:!0,shadowMappingEnabled:!1,verticalOffset:null,screenSizePerspective:null,slicePlaneEnabled:!1,sliceHighlightDisabled:!1,offsetTransparentBackfaces:!1,vvSizeEnabled:!1,vvSizeMinSize:[1,1,1],vvSizeMaxSize:[100,100,100],vvSizeOffset:[0,0,0],vvSizeFactor:[1,1,1],vvSizeValue:[1,1,1],vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],vvSymbolAnchor:[0,0,0],vvSymbolRotationMatrix:e(),transparent:!1,writeDepth:!0,textureAlphaMode:0,textureAlphaCutoff:d,textureAlphaPremultiplied:!1,sceneHasOcludees:!1,...f};class M{constructor(e,t){this.vertexBufferLayout=e,this.instanceBufferLayout=t}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get(\"position\").length}write(e,t,i,s){C(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,i,s)}}const w=u(),_=u(),B=c(0,0,1),E=u(),I=u(),A=u(),L=u();export{y as DefaultMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport r from\"../../../../core/Logger.js\";const e=r.getLogger(\"esri.views.3d.support.buffer.math\");export{e as logger};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{glsl as e}from\"../../shaderModules/interfaces.js\";function t(t,d){1===d.attributeTextureCoordinates&&(t.attributes.add(\"uv0\",\"vec2\"),t.varyings.add(\"vuv0\",\"vec2\"),t.vertex.code.add(e`void forwardTextureCoordinates() {\nvuv0 = uv0;\n}`)),2===d.attributeTextureCoordinates&&(t.attributes.add(\"uv0\",\"vec2\"),t.varyings.add(\"vuv0\",\"vec2\"),t.attributes.add(\"uvRegion\",\"vec4\"),t.varyings.add(\"vuvRegion\",\"vec4\"),t.vertex.code.add(e`void forwardTextureCoordinates() {\nvuv0 = uv0;\nvuvRegion = uvRegion;\n}`)),0===d.attributeTextureCoordinates&&t.vertex.code.add(e`void forwardTextureCoordinates() {}`)}export{t as TextureCoordinateAttribute};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{glsl as e}from\"../../shaderModules/interfaces.js\";function o(o){o.attributes.add(\"position\",\"vec3\"),o.vertex.code.add(e`vec3 positionModel() { return position; }`)}export{o as PositionAttribute};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{glsl as i}from\"../../shaderModules/interfaces.js\";function n(n,t){const e=n.fragment,a=void 0!==t.lightingSphericalHarmonicsOrder?t.lightingSphericalHarmonicsOrder:2;0===a?(e.uniforms.add(\"lightingAmbientSH0\",\"vec3\"),e.code.add(i`vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\nvec3 ambientLight = 0.282095 * lightingAmbientSH0;\nreturn ambientLight * (1.0 - ambientOcclusion);\n}`)):1===a?(e.uniforms.add(\"lightingAmbientSH_R\",\"vec4\"),e.uniforms.add(\"lightingAmbientSH_G\",\"vec4\"),e.uniforms.add(\"lightingAmbientSH_B\",\"vec4\"),e.code.add(i`vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\nvec4 sh0 = vec4(\n0.282095,\n0.488603 * normal.x,\n0.488603 * normal.z,\n0.488603 * normal.y\n);\nvec3 ambientLight = vec3(\ndot(lightingAmbientSH_R, sh0),\ndot(lightingAmbientSH_G, sh0),\ndot(lightingAmbientSH_B, sh0)\n);\nreturn ambientLight * (1.0 - ambientOcclusion);\n}`)):2===a&&(e.uniforms.add(\"lightingAmbientSH0\",\"vec3\"),e.uniforms.add(\"lightingAmbientSH_R1\",\"vec4\"),e.uniforms.add(\"lightingAmbientSH_G1\",\"vec4\"),e.uniforms.add(\"lightingAmbientSH_B1\",\"vec4\"),e.uniforms.add(\"lightingAmbientSH_R2\",\"vec4\"),e.uniforms.add(\"lightingAmbientSH_G2\",\"vec4\"),e.uniforms.add(\"lightingAmbientSH_B2\",\"vec4\"),e.code.add(i`vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\nvec3 ambientLight = 0.282095 * lightingAmbientSH0;\nvec4 sh1 = vec4(\n0.488603 * normal.x,\n0.488603 * normal.z,\n0.488603 * normal.y,\n1.092548 * normal.x * normal.y\n);\nvec4 sh2 = vec4(\n1.092548 * normal.y * normal.z,\n0.315392 * (3.0 * normal.z * normal.z - 1.0),\n1.092548 * normal.x * normal.z,\n0.546274 * (normal.x * normal.x - normal.y * normal.y)\n);\nambientLight += vec3(\ndot(lightingAmbientSH_R1, sh1),\ndot(lightingAmbientSH_G1, sh1),\ndot(lightingAmbientSH_B1, sh1)\n);\nambientLight += vec3(\ndot(lightingAmbientSH_R2, sh2),\ndot(lightingAmbientSH_G2, sh2),\ndot(lightingAmbientSH_B2, sh2)\n);\nreturn ambientLight * (1.0 - ambientOcclusion);\n}`),1!==t.pbrMode&&2!==t.pbrMode||e.code.add(i`const vec3 skyTransmittance = vec3(0.9, 0.9, 1.0);\nvec3 calculateAmbientRadiance(float ambientOcclusion)\n{\nvec3 ambientLight = 1.2 * (0.282095 * lightingAmbientSH0) - 0.2;\nreturn ambientLight *= (1.0 - ambientOcclusion) * skyTransmittance;\n}`))}export{n as EvaluateAmbientLighting};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{glsl as i}from\"../../shaderModules/interfaces.js\";function n(n){const t=n.fragment;t.uniforms.add(\"lightingMainDirection\",\"vec3\"),t.uniforms.add(\"lightingMainIntensity\",\"vec3\"),t.uniforms.add(\"lightingFixedFactor\",\"float\"),t.code.add(i`vec3 evaluateMainLighting(vec3 normal_global, float shadowing) {\nfloat dotVal = clamp(dot(normal_global, lightingMainDirection), 0.0, 1.0);\ndotVal = mix(dotVal, 1.0, lightingFixedFactor);\nreturn lightingMainIntensity * ((1.0 - shadowing) * dotVal);\n}`)}export{n as EvaluateMainLighting};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{EvaluateAmbientLighting as i}from\"./EvaluateAmbientLighting.glsl.js\";import{EvaluateAmbientOcclusion as n}from\"./EvaluateAmbientOcclusion.glsl.js\";import{EvaluateMainLighting as o}from\"./EvaluateMainLighting.glsl.js\";import{PhysicallyBasedRendering as e}from\"./PhysicallyBasedRendering.glsl.js\";import{PiUtils as t}from\"./PiUtils.glsl.js\";import{ReadShadowMap as a}from\"./ReadShadowMap.glsl.js\";import{glsl as r}from\"../../shaderModules/interfaces.js\";function l(l,d){const c=l.fragment;l.include(o),l.include(n,d),0!==d.pbrMode&&l.include(e,d),l.include(i,d),d.receiveShadows&&l.include(a,d),c.uniforms.add(\"lightingGlobalFactor\",\"float\"),c.uniforms.add(\"ambientBoostFactor\",\"float\"),l.include(t),c.code.add(r`\n    const float GAMMA_SRGB = 2.1;\n    const float INV_GAMMA_SRGB = 0.4761904;\n    ${0===d.pbrMode?\"\":\"const vec3 GROUND_REFLECTANCE = vec3(0.2);\"}\n  `),c.code.add(r`\n    float additionalDirectedAmbientLight(vec3 vPosWorld) {\n      float vndl = dot(${1===d.viewingMode?r`normalize(vPosWorld)`:r`vec3(0.0, 0.0, 1.0)`}, lightingMainDirection);\n      return smoothstep(0.0, 1.0, clamp(vndl * 2.5, 0.0, 1.0));\n    }\n  `),c.code.add(r`vec3 evaluateAdditionalLighting(float ambientOcclusion, vec3 vPosWorld) {\nfloat additionalAmbientScale = additionalDirectedAmbientLight(vPosWorld);\nreturn (1.0 - ambientOcclusion) * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor * lightingMainIntensity;\n}`),0===d.pbrMode||4===d.pbrMode?c.code.add(r`vec3 evaluateSceneLighting(vec3 normalWorld, vec3 albedo, float shadow, float ssao, vec3 additionalLight)\n{\nvec3 mainLighting = evaluateMainLighting(normalWorld, shadow);\nvec3 ambientLighting = calculateAmbientIrradiance(normalWorld, ssao);\nvec3 albedoLinear = pow(albedo, vec3(GAMMA_SRGB));\nvec3 totalLight = mainLighting + ambientLighting + additionalLight;\ntotalLight = min(totalLight, vec3(PI));\nvec3 outColor = vec3((albedoLinear / PI) * totalLight);\nreturn pow(outColor, vec3(INV_GAMMA_SRGB));\n}`):1!==d.pbrMode&&2!==d.pbrMode||(c.code.add(r`const float fillLightIntensity = 0.25;\nconst float horizonLightDiffusion = 0.4;\nconst float additionalAmbientIrradianceFactor = 0.02;\nvec3 evaluateSceneLightingPBR(vec3 normal, vec3 albedo, float shadow, float ssao, vec3 additionalLight, vec3 viewDir, vec3 normalGround, vec3 mrr, vec3 _emission, float additionalAmbientIrradiance)\n{\nvec3 viewDirection = -viewDir;\nvec3 mainLightDirection = lightingMainDirection;\nvec3 h = normalize(viewDirection + mainLightDirection);\nPBRShadingInfo inputs;\ninputs.NdotL = clamp(dot(normal, mainLightDirection), 0.001, 1.0);\ninputs.NdotV = clamp(abs(dot(normal, viewDirection)), 0.001, 1.0);\ninputs.NdotH = clamp(dot(normal, h), 0.0, 1.0);\ninputs.VdotH = clamp(dot(viewDirection, h), 0.0, 1.0);\ninputs.NdotNG = clamp(dot(normal, normalGround), -1.0, 1.0);\nvec3 reflectedView = normalize(reflect(viewDirection, normal));\ninputs.RdotNG = clamp(dot(reflectedView, normalGround), -1.0, 1.0);\ninputs.albedoLinear = pow(albedo, vec3(GAMMA_SRGB));\ninputs.ssao = ssao;\ninputs.metalness = mrr[0];\ninputs.roughness = clamp(mrr[1] * mrr[1], 0.001, 0.99);`),c.code.add(r`inputs.f0 = (0.16 * mrr[2] * mrr[2]) * (1.0 - inputs.metalness) + inputs.albedoLinear * inputs.metalness;\ninputs.f90 = vec3(clamp(dot(inputs.f0, vec3(50.0 * 0.33)), 0.0, 1.0));\ninputs.diffuseColor = inputs.albedoLinear * (vec3(1.0) - inputs.f0) * (1.0 - inputs.metalness);`),c.code.add(r`vec3 ambientDir = vec3(5.0 * normalGround[1] - normalGround[0] * normalGround[2], - 5.0 * normalGround[0] - normalGround[2] * normalGround[1], normalGround[1] * normalGround[1] + normalGround[0] * normalGround[0]);\nambientDir = ambientDir != vec3(0.0)? normalize(ambientDir) : normalize(vec3(5.0, -1.0, 0.0));\ninputs.NdotAmbDir = abs(dot(normal, ambientDir));\nvec3 mainLightIrradianceComponent = inputs.NdotL * (1.0 - shadow) * lightingMainIntensity;\nvec3 fillLightsIrradianceComponent = inputs.NdotAmbDir * lightingMainIntensity * fillLightIntensity;\nvec3 ambientLightIrradianceComponent = calculateAmbientIrradiance(normal, ssao) + additionalLight;\ninputs.skyIrradianceToSurface = ambientLightIrradianceComponent + mainLightIrradianceComponent + fillLightsIrradianceComponent ;\ninputs.groundIrradianceToSurface = GROUND_REFLECTANCE * ambientLightIrradianceComponent + mainLightIrradianceComponent + fillLightsIrradianceComponent ;`),c.code.add(r`vec3 horizonRingDir = inputs.RdotNG * normalGround - reflectedView;\nvec3 horizonRingH = normalize(viewDirection + horizonRingDir);\ninputs.NdotH_Horizon = dot(normal, horizonRingH);\nvec3 mainLightRadianceComponent = normalDistribution(inputs.NdotH, inputs.roughness) * lightingMainIntensity * (1.0 - shadow);\nvec3 horizonLightRadianceComponent = normalDistribution(inputs.NdotH_Horizon, min(inputs.roughness + horizonLightDiffusion, 1.0)) * lightingMainIntensity * fillLightIntensity;\nvec3 ambientLightRadianceComponent = calculateAmbientRadiance(ssao) + additionalLight;\ninputs.skyRadianceToSurface = ambientLightRadianceComponent + mainLightRadianceComponent + horizonLightRadianceComponent;\ninputs.groundRadianceToSurface = GROUND_REFLECTANCE * (ambientLightRadianceComponent + horizonLightRadianceComponent) + mainLightRadianceComponent;\ninputs.averageAmbientRadiance = ambientLightIrradianceComponent[1] * (1.0 + GROUND_REFLECTANCE[1]);`),c.code.add(r`\n        vec3 reflectedColorComponent = evaluateEnvironmentIllumination(inputs);\n        vec3 additionalMaterialReflectanceComponent = inputs.albedoLinear * additionalAmbientIrradiance;\n        vec3 emissionComponent = pow(_emission, vec3(GAMMA_SRGB));\n        vec3 outColorLinear = reflectedColorComponent + additionalMaterialReflectanceComponent + emissionComponent;\n        ${2===d.pbrMode?r`vec3 outColor = pow(max(vec3(0.0), outColorLinear - 0.005 * inputs.averageAmbientRadiance), vec3(INV_GAMMA_SRGB));`:r`vec3 outColor = pow(blackLevelSoftCompression(outColorLinear, inputs), vec3(INV_GAMMA_SRGB));`}\n        return outColor;\n      }\n    `))}export{l as EvaluateSceneLighting};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{glsl as e}from\"../../shaderModules/interfaces.js\";function o(o){const d=e`vec3 decodeNormal(vec2 f) {\nfloat z = 1.0 - abs(f.x) - abs(f.y);\nreturn vec3(f + sign(f) * min(z, 0.0), z);\n}`;o.fragment.code.add(d),o.vertex.code.add(d)}export{o as DecodeNormal};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{DecodeNormal as e}from\"../util/DecodeNormal.glsl.js\";import{glsl as r}from\"../../shaderModules/interfaces.js\";function o(o,d){0===d.normalType&&(o.attributes.add(\"normal\",\"vec3\"),o.vertex.code.add(r`vec3 normalModel() {\nreturn normal;\n}`)),1===d.normalType&&(o.include(e),o.attributes.add(\"normalCompressed\",\"vec2\"),o.vertex.code.add(r`vec3 normalModel() {\nreturn decodeNormal(normalCompressed);\n}`)),3===d.normalType&&(o.extensions.add(\"GL_OES_standard_derivatives\"),o.fragment.code.add(r`vec3 screenDerivativeNormal(vec3 positionView) {\nreturn normalize(cross(dFdx(positionView), dFdy(positionView)));\n}`))}export{o as NormalAttribute};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{c as e}from\"../../../../../../chunks/vec3f64.js\";import{DoublePrecision as i}from\"../util/DoublePrecision.glsl.js\";import{glsl as r}from\"../../shaderModules/interfaces.js\";import{encodeDoubleArraySplit as n}from\"../../../lib/doublePrecisionUtils.js\";function o(e,n){n.instanced&&n.instancedDoublePrecision&&(e.attributes.add(\"modelOriginHi\",\"vec3\"),e.attributes.add(\"modelOriginLo\",\"vec3\"),e.attributes.add(\"model\",\"mat3\"),e.attributes.add(\"modelNormal\",\"mat3\")),n.instancedDoublePrecision&&(e.vertex.include(i,n),e.vertex.uniforms.add(\"viewOriginHi\",\"vec3\"),e.vertex.uniforms.add(\"viewOriginLo\",\"vec3\"));const o=[r`\n    vec3 calculateVPos() {\n      ${n.instancedDoublePrecision?\"return model * localPosition().xyz;\":\"return localPosition().xyz;\"}\n    }\n    `,r`\n    vec3 subtractOrigin(vec3 _pos) {\n      ${n.instancedDoublePrecision?r`\n          vec3 originDelta = dpAdd(viewOriginHi, viewOriginLo, -modelOriginHi, -modelOriginLo);\n          return _pos - originDelta;`:\"return vpos;\"}\n    }\n    `,r`\n    vec3 dpNormal(vec4 _normal) {\n      ${n.instancedDoublePrecision?\"return normalize(modelNormal * _normal.xyz);\":\"return normalize(_normal.xyz);\"}\n    }\n    `,r`\n    vec3 dpNormalView(vec4 _normal) {\n      ${n.instancedDoublePrecision?\"return normalize((viewNormal * vec4(modelNormal * _normal.xyz, 1.0)).xyz);\":\"return normalize((viewNormal * _normal).xyz);\"}\n    }\n    `,n.vertexTangents?r`\n    vec4 dpTransformVertexTangent(vec4 _tangent) {\n      ${n.instancedDoublePrecision?\"return vec4(modelNormal * _tangent.xyz, _tangent.w);\":\"return _tangent;\"}\n\n    }\n    `:r``];e.vertex.code.add(o[0]),e.vertex.code.add(o[1]),e.vertex.code.add(o[2]),2===n.output&&e.vertex.code.add(o[3]),e.vertex.code.add(o[4])}!function(e){class i{}function r(e,i){n(i,t,a,3),e.setUniform3fv(\"viewOriginHi\",t),e.setUniform3fv(\"viewOriginLo\",a)}e.Uniforms=i,e.bindCustomOrigin=r}(o||(o={}));const t=e(),a=e();export{o as InstancedDoublePrecision};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{f as e}from\"../../../../../../chunks/vec3f32.js\";import{VertexTextureCoordinates as s}from\"../attributes/VertexTextureCoordinates.glsl.js\";import{glsl as o}from\"../../shaderModules/interfaces.js\";const t=e(0,.6,.2);function r(e,t){const r=e.fragment,a=t.hasMetalnessAndRoughnessTexture||t.hasEmissionTexture||t.hasOcclusionTexture;1===t.pbrMode&&a&&e.include(s,t),2!==t.pbrMode?(0===t.pbrMode&&r.code.add(o`float getBakedOcclusion() { return 1.0; }`),1===t.pbrMode&&(r.uniforms.add(\"emissionFactor\",\"vec3\"),r.uniforms.add(\"mrrFactors\",\"vec3\"),r.code.add(o`vec3 mrr;\nvec3 emission;\nfloat occlusion;`),t.hasMetalnessAndRoughnessTexture&&(r.uniforms.add(\"texMetallicRoughness\",\"sampler2D\"),t.supportsTextureAtlas&&r.uniforms.add(\"texMetallicRoughnessSize\",\"vec2\"),r.code.add(o`void applyMetallnessAndRoughness(TextureLookupParameter params) {\nvec3 metallicRoughness = textureLookup(texMetallicRoughness, params).rgb;\nmrr[0] *= metallicRoughness.b;\nmrr[1] *= metallicRoughness.g;\n}`)),t.hasEmissionTexture&&(r.uniforms.add(\"texEmission\",\"sampler2D\"),t.supportsTextureAtlas&&r.uniforms.add(\"texEmissionSize\",\"vec2\"),r.code.add(o`void applyEmission(TextureLookupParameter params) {\nemission *= textureLookup(texEmission, params).rgb;\n}`)),t.hasOcclusionTexture?(r.uniforms.add(\"texOcclusion\",\"sampler2D\"),t.supportsTextureAtlas&&r.uniforms.add(\"texOcclusionSize\",\"vec2\"),r.code.add(o`void applyOcclusion(TextureLookupParameter params) {\nocclusion *= textureLookup(texOcclusion, params).r;\n}\nfloat getBakedOcclusion() {\nreturn occlusion;\n}`)):r.code.add(o`float getBakedOcclusion() { return 1.0; }`),r.code.add(o`\n    void applyPBRFactors() {\n      mrr = mrrFactors;\n      emission = emissionFactor;\n      occlusion = 1.0;\n      ${a?\"vtc.uv = vuv0;\":\"\"}\n      ${t.hasMetalnessAndRoughnessTexture?t.supportsTextureAtlas?\"vtc.size = texMetallicRoughnessSize; applyMetallnessAndRoughness(vtc);\":\"applyMetallnessAndRoughness(vtc);\":\"\"}\n      ${t.hasEmissionTexture?t.supportsTextureAtlas?\"vtc.size = texEmissionSize; applyEmission(vtc);\":\"applyEmission(vtc);\":\"\"}\n      ${t.hasOcclusionTexture?t.supportsTextureAtlas?\"vtc.size = texOcclusionSize; applyOcclusion(vtc);\":\"applyOcclusion(vtc);\":\"\"}\n    }\n  `))):r.code.add(o`const vec3 mrr = vec3(0.0, 0.6, 0.2);\nconst vec3 emission = vec3(0.0);\nfloat occlusion = 1.0;\nvoid applyPBRFactors() {}\nfloat getBakedOcclusion() { return 1.0; }`)}function a(e,s,o=!1){o||(e.setUniform3fv(\"mrrFactors\",s.mrrFactors),e.setUniform3fv(\"emissionFactor\",s.emissiveFactor))}export{t as PBRSchematicMRRValues,r as PhysicallyBasedRenderingParameters,a as bindPBRUniforms};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{glsl as o}from\"../shaderModules/interfaces.js\";function e(e){e.vertex.code.add(o`vec4 offsetBackfacingClipPosition(vec4 posClip, vec3 posWorld, vec3 normalWorld, vec3 camPosWorld) {\nvec3 camToVert = posWorld - camPosWorld;\nbool isBackface = dot(camToVert, normalWorld) > 0.0;\nif (isBackface) {\nposClip.z += 0.0000003 * posClip.w;\n}\nreturn posClip;\n}`)}export{e as Offset};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{Slice as o}from\"../Slice.glsl.js\";import{Transform as r}from\"../Transform.glsl.js\";import{NormalAttribute as e}from\"../attributes/NormalAttribute.glsl.js\";import{TextureCoordinateAttribute as t}from\"../attributes/TextureCoordinateAttribute.glsl.js\";import{VertexNormal as i}from\"../attributes/VertexNormal.glsl.js\";import{OutputDepth as a}from\"../output/OutputDepth.glsl.js\";import{OutputHighlight as l}from\"../output/OutputHighlight.glsl.js\";import{VisualVariables as s}from\"../shading/VisualVariables.glsl.js\";import{DiscardOrAdjustAlpha as d}from\"../util/AlphaDiscard.glsl.js\";import{glsl as n}from\"../../shaderModules/interfaces.js\";function u(u,c){const p=u.vertex.code,v=u.fragment.code;1!==c.output&&3!==c.output||(u.include(r,{linearDepth:!0}),u.include(t,c),u.include(s,c),u.include(a,c),u.include(o,c),u.vertex.uniforms.add(\"cameraNearFar\",\"vec2\"),u.varyings.add(\"depth\",\"float\"),c.hasColorTexture&&u.fragment.uniforms.add(\"tex\",\"sampler2D\"),p.add(n`void main(void) {\nvpos = calculateVPos();\nvpos = subtractOrigin(vpos);\nvpos = addVerticalOffset(vpos, localOrigin);\ngl_Position = transformPositionWithDepth(proj, view, vpos, cameraNearFar, depth);\nforwardTextureCoordinates();\n}`),u.include(d,c),v.add(n`\n      void main(void) {\n        discardBySlice(vpos);\n        ${c.hasColorTexture?n`\n        vec4 texColor = texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);`:\"\"}\n        outputDepth(depth);\n      }\n    `)),2===c.output&&(u.include(r,{linearDepth:!1}),u.include(e,c),u.include(i,c),u.include(t,c),u.include(s,c),c.hasColorTexture&&u.fragment.uniforms.add(\"tex\",\"sampler2D\"),u.vertex.uniforms.add(\"viewNormal\",\"mat4\"),u.varyings.add(\"vPositionView\",\"vec3\"),p.add(n`\n      void main(void) {\n        vpos = calculateVPos();\n        vpos = subtractOrigin(vpos);\n        ${0===c.normalType?n`\n        vNormalWorld = dpNormalView(vvLocalNormal(normalModel()));`:\"\"}\n        vpos = addVerticalOffset(vpos, localOrigin);\n        gl_Position = transformPosition(proj, view, vpos);\n        forwardTextureCoordinates();\n      }\n    `),u.include(o,c),u.include(d,c),v.add(n`\n      void main() {\n        discardBySlice(vpos);\n        ${c.hasColorTexture?n`\n        vec4 texColor = texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);`:\"\"}\n\n        ${3===c.normalType?n`\n            vec3 normal = screenDerivativeNormal(vPositionView);`:n`\n            vec3 normal = normalize(vNormalWorld);\n            if (gl_FrontFacing == false) normal = -normal;`}\n        gl_FragColor = vec4(vec3(0.5) + 0.5 * normal, 1.0);\n      }\n    `)),4===c.output&&(u.include(r,{linearDepth:!1}),u.include(t,c),u.include(s,c),c.hasColorTexture&&u.fragment.uniforms.add(\"tex\",\"sampler2D\"),p.add(n`void main(void) {\nvpos = calculateVPos();\nvpos = subtractOrigin(vpos);\nvpos = addVerticalOffset(vpos, localOrigin);\ngl_Position = transformPosition(proj, view, vpos);\nforwardTextureCoordinates();\n}`),u.include(o,c),u.include(d,c),u.include(l),v.add(n`\n      void main() {\n        discardBySlice(vpos);\n        ${c.hasColorTexture?n`\n        vec4 texColor = texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);`:\"\"}\n        outputHighlight();\n      }\n    `))}export{u as DefaultMaterialAuxiliaryPasses};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{glsl as a}from\"../../shaderModules/interfaces.js\";function r(r,e){const m=r.fragment;m.code.add(a`struct ShadingNormalParameters {\nvec3 normalView;\nvec3 viewDirection;\n} shadingParams;`),1===e.doubleSidedMode?m.code.add(a`vec3 shadingNormal(ShadingNormalParameters params) {\nreturn dot(params.normalView, params.viewDirection) > 0.0 ? normalize(-params.normalView) : normalize(params.normalView);\n}`):2===e.doubleSidedMode?m.code.add(a`vec3 shadingNormal(ShadingNormalParameters params) {\nreturn gl_FrontFacing ? normalize(params.normalView) : normalize(-params.normalView);\n}`):m.code.add(a`vec3 shadingNormal(ShadingNormalParameters params) {\nreturn normalize(params.normalView);\n}`)}export{r as Normals};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{ColorConversion as e}from\"./ColorConversion.glsl.js\";import{glsl as t}from\"../../shaderModules/interfaces.js\";function i(i){i.include(e),i.code.add(t`\n    vec3 mixExternalColor(vec3 internalColor, vec3 textureColor, vec3 externalColor, int mode) {\n      // workaround for artifacts in OSX using Intel Iris Pro\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10475\n      vec3 internalMixed = internalColor * textureColor;\n      vec3 allMixed = internalMixed * externalColor;\n\n      if (mode == ${t.int(1)}) {\n        return allMixed;\n      }\n      else if (mode == ${t.int(2)}) {\n        return internalMixed;\n      }\n      else if (mode == ${t.int(3)}) {\n        return externalColor;\n      }\n      else {\n        // tint (or something invalid)\n        float vIn = rgb2v(internalMixed);\n        vec3 hsvTint = rgb2hsv(externalColor);\n        vec3 hsvOut = vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\n        return hsv2rgb(hsvOut);\n      }\n    }\n\n    float mixExternalOpacity(float internalOpacity, float textureOpacity, float externalOpacity, int mode) {\n      // workaround for artifacts in OSX using Intel Iris Pro\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10475\n      float internalMixed = internalOpacity * textureOpacity;\n      float allMixed = internalMixed * externalOpacity;\n\n      if (mode == ${t.int(2)}) {\n        return internalMixed;\n      }\n      else if (mode == ${t.int(3)}) {\n        return externalOpacity;\n      }\n      else {\n        // multiply or tint (or something invalid)\n        return allMixed;\n      }\n    }\n  `)}export{i as MixExternalColor};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isNone as e,isSome as n}from\"../../../../core/maybe.js\";import{f as t}from\"../../../../chunks/vec3f64.js\";import o from\"../../../webgl/BufferObject.js\";import i from\"../../../webgl/FramebufferObject.js\";import{Program as r}from\"../../../webgl/Program.js\";import\"../../../webgl/enums.js\";import\"../../../webgl/RenderingContext.js\";import\"../../../webgl/Texture.js\";import s from\"../../../webgl/VertexArrayObject.js\";import{encodeDoubleArray as c}from\"./doublePrecisionUtils.js\";import{unpackFloatRGBA as a}from\"./Util.js\";import{testSVGPremultipliedAlpha as l}from\"../../../webgl/testSVGPremultipliedAlpha.js\";class u{constructor(e){this.context=e,this.svgAlwaysPremultipliesAlpha=!1,this._doublePrecisionRequiresObfuscation=null,l(e).then((e=>this.svgAlwaysPremultipliesAlpha=!e))}get doublePrecisionRequiresObfuscation(){if(e(this._doublePrecisionRequiresObfuscation)){const e=h(this.context,!1),n=h(this.context,!0);this._doublePrecisionRequiresObfuscation=0!==e&&(0===n||e/n>5)}return this._doublePrecisionRequiresObfuscation}}let p=null;function f(n){return(e(p)||p.context!==n)&&(p=new u(n)),p}function v(e){n(p)&&p.context===e&&(p=null)}function h(e,n){const l=new i(e,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1});function u(t,o){const i=new r(e,`\\n\\n  precision highp float;\\n\\n  attribute vec2 position;\\n\\n  uniform vec3 u_highA;\\n  uniform vec3 u_lowA;\\n  uniform vec3 u_highB;\\n  uniform vec3 u_lowB;\\n\\n  varying vec4 v_color;\\n\\n  ${n?\"#define DOUBLE_PRECISION_REQUIRES_OBFUSCATION\":\"\"}\\n\\n  #ifdef DOUBLE_PRECISION_REQUIRES_OBFUSCATION\\n\\n  vec3 dpPlusFrc(vec3 a, vec3 b) {\\n    return mix(a, a + b, vec3(notEqual(b, vec3(0))));\\n  }\\n\\n  vec3 dpMinusFrc(vec3 a, vec3 b) {\\n    return mix(vec3(0), a - b, vec3(notEqual(a, b)));\\n  }\\n\\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\\n    vec3 t1 = dpPlusFrc(hiA, hiB);\\n    vec3 e = dpMinusFrc(t1, hiA);\\n    vec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\\n    return t1 + t2;\\n  }\\n\\n  #else\\n\\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\\n    vec3 t1 = hiA + hiB;\\n    vec3 e = t1 - hiA;\\n    vec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\\n    return t1 + t2;\\n  }\\n\\n  #endif\\n\\n  const float MAX_RGBA_FLOAT =\\n    255.0 / 256.0 +\\n    255.0 / 256.0 / 256.0 +\\n    255.0 / 256.0 / 256.0 / 256.0 +\\n    255.0 / 256.0 / 256.0 / 256.0 / 256.0;\\n\\n  const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\\n\\n  vec4 float2rgba(const float value) {\\n    // Make sure value is in the domain we can represent\\n    float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);\\n\\n    // Decompose value in 32bit fixed point parts represented as\\n    // uint8 rgba components. Decomposition uses the fractional part after multiplying\\n    // by a power of 256 (this removes the bits that are represented in the previous\\n    // component) and then converts the fractional part to 8bits.\\n    vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\\n\\n    // Convert uint8 values (from 0 to 255) to floating point representation for\\n    // the shader\\n    const float toU8AsFloat = 1.0 / 255.0;\\n\\n    return fixedPointU8 * toU8AsFloat;\\n  }\\n\\n  void main() {\\n    vec3 val = dpAdd(u_highA, u_lowA, -u_highB, -u_lowB);\\n\\n    v_color = float2rgba(val.z / 25.0);\\n\\n    gl_Position = vec4(position * 2.0 - 1.0, 0.0, 1.0);\\n  }\\n  `,\"\\n  precision highp float;\\n\\n  varying vec4 v_color;\\n\\n  void main() {\\n    gl_FragColor = v_color;\\n  }\\n  \",new Map([[\"position\",0]])),s=new Float32Array(6);c(t,s,3);const a=new Float32Array(6);return c(o,a,3),e.useProgram(i),i.setUniform3f(\"u_highA\",s[0],s[2],s[4]),i.setUniform3f(\"u_lowA\",s[1],s[3],s[5]),i.setUniform3f(\"u_highB\",a[0],a[2],a[4]),i.setUniform3f(\"u_lowB\",a[1],a[3],a[5]),i}const p=o.createVertex(e,35044,new Uint16Array([0,0,1,0,0,1,1,1])),f=new s(e,new Map([[\"position\",0]]),{geometry:[{name:\"position\",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:p}),v=t(5633261.287538229,2626832.878767164,1434988.0495278358),h=t(5633271.46742708,2626873.6381334523,1434963.231608387),m=u(v,h),d=e.getBoundFramebufferObject(),{x:b,y:A,width:g,height:_}=e.getViewport();e.bindFramebuffer(l),e.setViewport(0,0,1,1),e.bindVAO(f),e.drawArrays(5,0,4);const w=new Uint8Array(4);l.readPixels(0,0,1,1,6408,5121,w),m.dispose(),f.dispose(!1),p.dispose(),l.dispose(),e.setViewport(b,A,g,_),e.bindFramebuffer(d);const F=(v[2]-h[2])/25,B=a(w);return Math.abs(F-B)}export{v as clearTestWebGLDriver,f as testWebGLDriver};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../../../../core/has.js\";import{glsl as c}from\"../../shaderModules/interfaces.js\";import{testWebGLDriver as i}from\"../../../lib/WebGLDriverTest.js\";function r({code:e},i){i.doublePrecisionRequiresObfuscation?e.add(c`vec3 dpPlusFrc(vec3 a, vec3 b) {\nreturn mix(a, a + b, vec3(notEqual(b, vec3(0))));\n}\nvec3 dpMinusFrc(vec3 a, vec3 b) {\nreturn mix(vec3(0), a - b, vec3(notEqual(a, b)));\n}\nvec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\nvec3 t1 = dpPlusFrc(hiA, hiB);\nvec3 e = dpMinusFrc(t1, hiA);\nvec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\nreturn t1 + t2;\n}`):e.add(c`vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\nvec3 t1 = hiA + hiB;\nvec3 e = t1 - hiA;\nvec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\nreturn t1 + t2;\n}`)}function o(c){return!!e(\"force-double-precision-obfuscation\")||i(c).doublePrecisionRequiresObfuscation}export{r as DoublePrecision,o as doublePrecisionRequiresObfuscation};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{glsl as o}from\"../../../../core/shaderModules/interfaces.js\";function l(l){l.vertex.code.add(o`\n    vec4 decodeSymbolColor(vec4 symbolColor, out int colorMixMode) {\n      float symbolAlpha = 0.0;\n\n      const float maxTint = 85.0;\n      const float maxReplace = 170.0;\n      const float scaleAlpha = 3.0;\n\n      if (symbolColor.a > maxReplace) {\n        colorMixMode = ${o.int(1)};\n        symbolAlpha = scaleAlpha * (symbolColor.a - maxReplace);\n      } else if (symbolColor.a > maxTint) {\n        colorMixMode = ${o.int(3)};\n        symbolAlpha = scaleAlpha * (symbolColor.a - maxTint);\n      } else if (symbolColor.a > 0.0) {\n        colorMixMode = ${o.int(4)};\n        symbolAlpha = scaleAlpha * symbolColor.a;\n      } else {\n        colorMixMode = ${o.int(1)};\n        symbolAlpha = 0.0;\n      }\n\n      return vec4(symbolColor.r, symbolColor.g, symbolColor.b, symbolAlpha);\n    }\n  `)}export{l as DecodeSymbolColor};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{DecodeSymbolColor as o}from\"../../../collections/Component/Material/shader/DecodeSymbolColor.glsl.js\";import{glsl as e}from\"../../shaderModules/interfaces.js\";function r(r,l){l.symbolColor?(r.include(o),r.attributes.add(\"symbolColor\",\"vec4\"),r.varyings.add(\"colorMixMode\",\"mediump float\")):r.fragment.uniforms.add(\"colorMixMode\",\"int\"),l.symbolColor?r.vertex.code.add(e`int symbolColorMixMode;\nvec4 getSymbolColor() {\nreturn decodeSymbolColor(symbolColor, symbolColorMixMode) * 0.003921568627451;\n}\nvoid forwardColorMixMode() {\ncolorMixMode = float(symbolColorMixMode) + 0.5;\n}`):r.vertex.code.add(e`vec4 getSymbolColor() { return vec4(1.0); }\nvoid forwardColorMixMode() {}`)}export{r as SymbolColor};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{c as o}from\"../../../../../../chunks/mat3f64.js\";import{c as r}from\"../../../../../../chunks/mat4f64.js\";import{c as e}from\"../../../../../../chunks/vec3f64.js\";import{PositionAttribute as i}from\"./PositionAttribute.glsl.js\";import{DoublePrecision as m}from\"../util/DoublePrecision.glsl.js\";import{glsl as a}from\"../../shaderModules/interfaces.js\";function d(o,r){o.include(i),o.vertex.include(m,r),o.varyings.add(\"vPositionWorldCameraRelative\",\"vec3\"),o.varyings.add(\"vPosition_view\",\"vec3\"),o.vertex.uniforms.add(\"uTransform_WorldFromModel_RS\",\"mat3\"),o.vertex.uniforms.add(\"uTransform_WorldFromModel_TH\",\"vec3\"),o.vertex.uniforms.add(\"uTransform_WorldFromModel_TL\",\"vec3\"),o.vertex.uniforms.add(\"uTransform_WorldFromView_TH\",\"vec3\"),o.vertex.uniforms.add(\"uTransform_WorldFromView_TL\",\"vec3\"),o.vertex.uniforms.add(\"uTransform_ViewFromCameraRelative_RS\",\"mat3\"),o.vertex.uniforms.add(\"uTransform_ProjFromView\",\"mat4\"),o.vertex.code.add(a`vec3 positionWorldCameraRelative() {\nvec3 rotatedModelPosition = uTransform_WorldFromModel_RS * positionModel();\nvec3 transform_CameraRelativeFromModel = dpAdd(\nuTransform_WorldFromModel_TL,\nuTransform_WorldFromModel_TH,\n-uTransform_WorldFromView_TL,\n-uTransform_WorldFromView_TH\n);\nreturn transform_CameraRelativeFromModel + rotatedModelPosition;\n}\nvec3 position_view() {\nreturn uTransform_ViewFromCameraRelative_RS * positionWorldCameraRelative();\n}\nvoid forwardPosition() {\nvPositionWorldCameraRelative = positionWorldCameraRelative();\nvPosition_view = position_view();\ngl_Position = uTransform_ProjFromView * vec4(vPosition_view, 1.0);\n}\nvec3 positionWorld() {\nreturn uTransform_WorldFromView_TL + vPositionWorldCameraRelative;\n}`),o.fragment.uniforms.add(\"uTransform_WorldFromView_TL\",\"vec3\"),o.fragment.code.add(a`vec3 positionWorld() {\nreturn uTransform_WorldFromView_TL + vPositionWorldCameraRelative;\n}`)}!function(i){class m{constructor(){this.worldFromModel_RS=o(),this.worldFromModel_TH=e(),this.worldFromModel_TL=e()}}i.ModelTransform=m;class a{constructor(){this.worldFromView_TH=e(),this.worldFromView_TL=e(),this.viewFromCameraRelative_RS=o(),this.projFromView=r()}}function d(o,r){o.setUniformMatrix3fv(\"uTransform_WorldFromModel_RS\",r.worldFromModel_RS),o.setUniform3fv(\"uTransform_WorldFromModel_TH\",r.worldFromModel_TH),o.setUniform3fv(\"uTransform_WorldFromModel_TL\",r.worldFromModel_TL)}function s(o,r){o.setUniform3fv(\"uTransform_WorldFromView_TH\",r.worldFromView_TH),o.setUniform3fv(\"uTransform_WorldFromView_TL\",r.worldFromView_TL),o.setUniformMatrix4fv(\"uTransform_ProjFromView\",r.projFromView),o.setUniformMatrix3fv(\"uTransform_ViewFromCameraRelative_RS\",r.viewFromCameraRelative_RS)}i.ViewProjectionTransform=a,i.bindModelTransform=d,i.bindViewProjTransform=s}(d||(d={}));export{d as VertexPosition};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{NormalAttribute as o}from\"./NormalAttribute.glsl.js\";import{VertexPosition as r}from\"./VertexPosition.glsl.js\";import{glsl as a}from\"../../shaderModules/interfaces.js\";function l(l,e){0===e.normalType||1===e.normalType?(l.include(o,e),l.varyings.add(\"vNormalWorld\",\"vec3\"),l.varyings.add(\"vNormalView\",\"vec3\"),l.vertex.uniforms.add(\"uTransformNormal_GlobalFromModel\",\"mat3\"),l.vertex.uniforms.add(\"uTransformNormal_ViewFromGlobal\",\"mat3\"),l.vertex.code.add(a`void forwardNormal() {\nvNormalWorld = uTransformNormal_GlobalFromModel * normalModel();\nvNormalView = uTransformNormal_ViewFromGlobal * vNormalWorld;\n}`)):2===e.normalType?(l.include(r,e),l.varyings.add(\"vNormalWorld\",\"vec3\"),l.vertex.code.add(a`\n    void forwardNormal() {\n      vNormalWorld = ${1===e.viewingMode?a`normalize(vPositionWorldCameraRelative);`:a`vec3(0.0, 0.0, 1.0);`}\n    }\n    `)):l.vertex.code.add(a`void forwardNormal() {}`)}!function(o){function r(o,r){o.setUniformMatrix4fv(\"viewNormal\",r)}o.bindUniforms=r}(l||(l={}));export{l as VertexNormal};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"./BufferObject.js\";import t from\"./FramebufferObject.js\";import{Program as r}from\"./Program.js\";import i from\"./Texture.js\";import o from\"./VertexArrayObject.js\";async function n(n){const a=new Image;if(a.src=\"data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='5' height='5' version='1.1' viewBox='0 0 5 5' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='5' height='5' fill='%23f00' fill-opacity='.5'/%3E%3C/svg%3E%0A\",a.width=5,a.height=5,await a.decode(),!n.gl)return!0;const s=new t(n,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1}),p=e.createVertex(n,35044,new Uint16Array([0,0,1,0,0,1,1,1])),m=new o(n,new Map([[\"a_pos\",0]]),{geometry:[{name:\"a_pos\",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:p}),d=new r(n,\"\\n  precision highp float;\\n\\n  attribute vec2 a_pos;\\n  varying vec2 v_uv;\\n\\n  void main() {\\n    v_uv = a_pos;\\n    gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\\n  }\\n  \",\"\\n  precision highp float;\\n\\n  varying vec2 v_uv;\\n  uniform sampler2D u_texture;\\n\\n  void main() {\\n    gl_FragColor = texture2D(u_texture, v_uv);\\n  }\\n  \",new Map([[\"a_pos\",0]]));n.useProgram(d);const g=new i(n,{dataType:5121,pixelFormat:6408,preMultiplyAlpha:!1,wrapMode:33071,samplingMode:9729},a);n.bindTexture(g,0),d.setUniform1i(\"u_texture\",0);const c=n.getBoundFramebufferObject(),{x:u,y:f,width:w,height:l}=n.getViewport();n.bindFramebuffer(s),n.setViewport(0,0,1,1),n.bindVAO(m),n.drawArrays(5,0,4);const v=new Uint8Array(4);return s.readPixels(0,0,1,1,6408,5121,v),d.dispose(),m.dispose(!1),p.dispose(),s.dispose(),g.dispose(),n.setViewport(u,f,w,l),n.bindFramebuffer(c),a.src=\"\",255===v[0]}export{n as testSVGPremultipliedAlpha};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{ForwardLinearDepth as e}from\"../views/3d/webgl-engine/core/shaderLibrary/ForwardLinearDepth.glsl.js\";import{Offset as r}from\"../views/3d/webgl-engine/core/shaderLibrary/Offset.glsl.js\";import{Slice as o}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as a}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{InstancedDoublePrecision as i}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/InstancedDoublePrecision.glsl.js\";import{NormalAttribute as l}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/NormalAttribute.glsl.js\";import{PositionAttribute as t}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/PositionAttribute.glsl.js\";import{SymbolColor as n}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/SymbolColor.glsl.js\";import{TextureCoordinateAttribute as d}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl.js\";import{VertexColor as s}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/VertexColor.glsl.js\";import{VertexNormal as c}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/VertexNormal.glsl.js\";import{VerticalOffset as g}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/VerticalOffset.glsl.js\";import{DefaultMaterialAuxiliaryPasses as m}from\"../views/3d/webgl-engine/core/shaderLibrary/default/DefaultMaterialAuxiliaryPasses.glsl.js\";import{ReadLinearDepth as v}from\"../views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl.js\";import{ComputeNormalTexture as p}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/ComputeNormalTexture.glsl.js\";import{EvaluateAmbientOcclusion as u}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateAmbientOcclusion.glsl.js\";import{EvaluateSceneLighting as b}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateSceneLighting.glsl.js\";import{multipassTerrainTest as h}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{Normals as f}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/Normals.glsl.js\";import{PhysicallyBasedRendering as x}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRendering.glsl.js\";import{PhysicallyBasedRenderingParameters as w}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl.js\";import{ReadShadowMap as y}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/ReadShadowMap.glsl.js\";import{VisualVariables as C}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl.js\";import{symbolAlphaCutoff as L,DiscardOrAdjustAlpha as j}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl.js\";import{HeaderComment as M}from\"../views/3d/webgl-engine/core/shaderLibrary/util/HeaderComment.glsl.js\";import{MixExternalColor as T}from\"../views/3d/webgl-engine/core/shaderLibrary/util/MixExternalColor.glsl.js\";import{glsl as E}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as O}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function P(P){const _=new O,S=_.vertex.code,$=_.fragment.code;return _.include(M,{name:\"Default Material Shader\",output:P.output}),_.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\").add(\"camPos\",\"vec3\").add(\"localOrigin\",\"vec3\"),_.include(t),_.varyings.add(\"vpos\",\"vec3\"),_.include(C,P),_.include(i,P),_.include(g,P),0!==P.output&&7!==P.output||(_.include(l,P),_.include(a,{linearDepth:!1}),0===P.normalType&&P.offsetBackfaces&&_.include(r),_.include(p,P),_.include(c,P),P.instancedColor&&_.attributes.add(\"instanceColor\",\"vec4\"),_.varyings.add(\"localvpos\",\"vec3\"),_.include(d,P),_.include(e,P),_.include(n,P),_.include(s,P),_.vertex.uniforms.add(\"externalColor\",\"vec4\"),_.varyings.add(\"vcolorExt\",\"vec4\"),P.multipassTerrainEnabled&&_.varyings.add(\"depth\",\"float\"),S.add(E`\n      void main(void) {\n        forwardNormalizedVertexColor();\n        vcolorExt = externalColor;\n        ${P.instancedColor?\"vcolorExt *= instanceColor;\":\"\"}\n        vcolorExt *= vvColor();\n        vcolorExt *= getSymbolColor();\n        forwardColorMixMode();\n\n        if (vcolorExt.a < ${E.float(L)}) {\n          gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n        }\n        else {\n          vpos = calculateVPos();\n          localvpos = vpos - view[3].xyz;\n          vpos = subtractOrigin(vpos);\n          ${0===P.normalType?E`\n          vNormalWorld = dpNormal(vvLocalNormal(normalModel()));`:\"\"}\n          vpos = addVerticalOffset(vpos, localOrigin);\n          ${P.vertexTangents?\"vTangent = dpTransformVertexTangent(tangent);\":\"\"}\n          gl_Position = transformPosition(proj, view, vpos);\n          ${0===P.normalType&&P.offsetBackfaces?\"gl_Position = offsetBackfacingClipPosition(gl_Position, vpos, vNormalWorld, camPos);\":\"\"}\n        }\n\n        ${P.multipassTerrainEnabled?\"depth = (view * vec4(vpos, 1.0)).z;\":\"\"}\n        forwardLinearDepth();\n        forwardTextureCoordinates();\n      }\n    `)),7===P.output&&(_.include(o,P),_.include(j,P),P.multipassTerrainEnabled&&(_.fragment.include(v),_.include(h,P)),_.fragment.uniforms.add(\"camPos\",\"vec3\").add(\"localOrigin\",\"vec3\").add(\"opacity\",\"float\").add(\"layerOpacity\",\"float\"),P.hasColorTexture&&_.fragment.uniforms.add(\"tex\",\"sampler2D\"),_.fragment.include(T),$.add(E`\n      void main() {\n        discardBySlice(vpos);\n        ${P.multipassTerrainEnabled?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n        ${P.hasColorTexture?E`\n        vec4 texColor = texture2D(tex, vuv0);\n        ${P.textureAlphaPremultiplied?\"texColor.rgb /= texColor.a;\":\"\"}\n        discardOrAdjustAlpha(texColor);`:E`vec4 texColor = vec4(1.0);`}\n        ${P.attributeColor?E`\n        float opacity_ = layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));`:E`\n        float opacity_ = layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        `}\n        gl_FragColor = vec4(opacity_);\n      }\n    `)),0===P.output&&(_.include(o,P),_.include(b,P),_.include(u,P),_.include(j,P),P.receiveShadows&&_.include(y,P),P.multipassTerrainEnabled&&(_.fragment.include(v),_.include(h,P)),_.fragment.uniforms.add(\"camPos\",\"vec3\").add(\"localOrigin\",\"vec3\").add(\"ambient\",\"vec3\").add(\"diffuse\",\"vec3\").add(\"opacity\",\"float\").add(\"layerOpacity\",\"float\"),P.hasColorTexture&&_.fragment.uniforms.add(\"tex\",\"sampler2D\"),_.include(w,P),_.include(x,P),_.fragment.include(T),_.include(f,P),$.add(E`\n      void main() {\n        discardBySlice(vpos);\n        ${P.multipassTerrainEnabled?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n        ${P.hasColorTexture?E`\n        vec4 texColor = texture2D(tex, vuv0);\n        ${P.textureAlphaPremultiplied?\"texColor.rgb /= texColor.a;\":\"\"}\n        discardOrAdjustAlpha(texColor);`:E`vec4 texColor = vec4(1.0);`}\n        shadingParams.viewDirection = normalize(vpos - camPos);\n        ${3===P.normalType?E`\n        vec3 normal = screenDerivativeNormal(localvpos);`:E`\n        shadingParams.normalView = vNormalWorld;\n        vec3 normal = shadingNormal(shadingParams);`}\n        ${1===P.pbrMode?\"applyPBRFactors();\":\"\"}\n        float ssao = evaluateAmbientOcclusionInverse();\n        ssao *= getBakedOcclusion();\n\n        float additionalAmbientScale = additionalDirectedAmbientLight(vpos + localOrigin);\n        vec3 additionalLight = ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n        ${P.receiveShadows?\"float shadow = readShadowMap(vpos, linearDepth);\":1===P.viewingMode?\"float shadow = lightingGlobalFactor * (1.0 - additionalAmbientScale);\":\"float shadow = 0.0;\"}\n        vec3 matColor = max(ambient, diffuse);\n        ${P.attributeColor?E`\n        vec3 albedo_ = mixExternalColor(vColor.rgb * matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ = layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));`:E`\n        vec3 albedo_ = mixExternalColor(matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ = layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        `}\n        ${P.hasNormalTexture?E`\n              mat3 tangentSpace = ${P.vertexTangents?\"computeTangentSpace(normal);\":\"computeTangentSpace(normal, vpos, vuv0);\"}\n              vec3 shadedNormal = computeTextureNormal(tangentSpace, vuv0);`:\"vec3 shadedNormal = normal;\"}\n        ${1===P.pbrMode||2===P.pbrMode?1===P.viewingMode?E`vec3 normalGround = normalize(vpos + localOrigin);`:E`vec3 normalGround = vec3(0.0, 0.0, 1.0);`:E``}\n        ${1===P.pbrMode||2===P.pbrMode?E`\n            float additionalAmbientIrradiance = additionalAmbientIrradianceFactor * lightingMainIntensity[2];\n            vec3 shadedColor = evaluateSceneLightingPBR(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight, shadingParams.viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);`:\"vec3 shadedColor = evaluateSceneLighting(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight);\"}\n        gl_FragColor = highlightSlice(vec4(shadedColor, opacity_), vpos);\n        ${P.OITEnabled?\"gl_FragColor = premultiplyAlpha(gl_FragColor);\":\"\"}\n      }\n    `)),_.include(m,P),_}var _=Object.freeze({__proto__:null,build:P});export{_ as D,P as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{ForwardLinearDepth as e}from\"../views/3d/webgl-engine/core/shaderLibrary/ForwardLinearDepth.glsl.js\";import{Offset as o}from\"../views/3d/webgl-engine/core/shaderLibrary/Offset.glsl.js\";import{Slice as r}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as a}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{InstancedDoublePrecision as i}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/InstancedDoublePrecision.glsl.js\";import{NormalAttribute as l}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/NormalAttribute.glsl.js\";import{PositionAttribute as t}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/PositionAttribute.glsl.js\";import{SymbolColor as d}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/SymbolColor.glsl.js\";import{TextureCoordinateAttribute as n}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl.js\";import{VertexColor as s}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/VertexColor.glsl.js\";import{VerticalOffset as c}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/VerticalOffset.glsl.js\";import{DefaultMaterialAuxiliaryPasses as g}from\"../views/3d/webgl-engine/core/shaderLibrary/default/DefaultMaterialAuxiliaryPasses.glsl.js\";import{ReadLinearDepth as v}from\"../views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl.js\";import{EvaluateAmbientOcclusion as m}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateAmbientOcclusion.glsl.js\";import{EvaluateSceneLighting as p}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateSceneLighting.glsl.js\";import{multipassTerrainTest as u}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{PhysicallyBasedRendering as b}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRendering.glsl.js\";import{PhysicallyBasedRenderingParameters as f}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl.js\";import{ReadShadowMap as h}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/ReadShadowMap.glsl.js\";import{VisualVariables as w}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl.js\";import{symbolAlphaCutoff as x,DiscardOrAdjustAlpha as y}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl.js\";import{MixExternalColor as C}from\"../views/3d/webgl-engine/core/shaderLibrary/util/MixExternalColor.glsl.js\";import{glsl as L}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as M}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function j(j){const E=new M,O=E.vertex.code,_=E.fragment.code;return E.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\").add(\"camPos\",\"vec3\").add(\"localOrigin\",\"vec3\"),E.include(t),E.varyings.add(\"vpos\",\"vec3\"),E.include(w,j),E.include(i,j),E.include(c,j),0!==j.output&&7!==j.output||(E.include(l,j),E.include(a,{linearDepth:!1}),j.offsetBackfaces&&E.include(o),j.instancedColor&&E.attributes.add(\"instanceColor\",\"vec4\"),E.varyings.add(\"vNormalWorld\",\"vec3\"),E.varyings.add(\"localvpos\",\"vec3\"),j.multipassTerrainEnabled&&E.varyings.add(\"depth\",\"float\"),E.include(n,j),E.include(e,j),E.include(d,j),E.include(s,j),E.vertex.uniforms.add(\"externalColor\",\"vec4\"),E.varyings.add(\"vcolorExt\",\"vec4\"),O.add(L`\n        void main(void) {\n          forwardNormalizedVertexColor();\n          vcolorExt = externalColor;\n          ${j.instancedColor?\"vcolorExt *= instanceColor;\":\"\"}\n          vcolorExt *= vvColor();\n          vcolorExt *= getSymbolColor();\n          forwardColorMixMode();\n\n          if (vcolorExt.a < ${L.float(x)}) {\n            gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n          }\n          else {\n            vpos = calculateVPos();\n            localvpos = vpos - view[3].xyz;\n            vpos = subtractOrigin(vpos);\n            vNormalWorld = dpNormal(vvLocalNormal(normalModel()));\n            vpos = addVerticalOffset(vpos, localOrigin);\n            gl_Position = transformPosition(proj, view, vpos);\n            ${j.offsetBackfaces?\"gl_Position = offsetBackfacingClipPosition(gl_Position, vpos, vNormalWorld, camPos);\":\"\"}\n          }\n          ${j.multipassTerrainEnabled?L`depth = (view * vec4(vpos, 1.0)).z;`:\"\"}\n          forwardLinearDepth();\n          forwardTextureCoordinates();\n        }\n      `)),7===j.output&&(E.include(r,j),E.include(y,j),j.multipassTerrainEnabled&&(E.fragment.include(v),E.include(u,j)),E.fragment.uniforms.add(\"camPos\",\"vec3\").add(\"localOrigin\",\"vec3\").add(\"opacity\",\"float\").add(\"layerOpacity\",\"float\"),E.fragment.uniforms.add(\"view\",\"mat4\"),j.hasColorTexture&&E.fragment.uniforms.add(\"tex\",\"sampler2D\"),E.fragment.include(C),_.add(L`\n      void main() {\n        discardBySlice(vpos);\n        ${j.multipassTerrainEnabled?L`terrainDepthTest(gl_FragCoord, depth);`:\"\"}\n        ${j.hasColorTexture?L`\n        vec4 texColor = texture2D(tex, vuv0);\n        ${j.textureAlphaPremultiplied?\"texColor.rgb /= texColor.a;\":\"\"}\n        discardOrAdjustAlpha(texColor);`:L`vec4 texColor = vec4(1.0);`}\n        ${j.attributeColor?L`\n        float opacity_ = layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));`:L`\n        float opacity_ = layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        `}\n\n        gl_FragColor = vec4(opacity_);\n      }\n    `)),0===j.output&&(E.include(r,j),E.include(p,j),E.include(m,j),E.include(y,j),j.receiveShadows&&E.include(h,j),j.multipassTerrainEnabled&&(E.fragment.include(v),E.include(u,j)),E.fragment.uniforms.add(\"camPos\",\"vec3\").add(\"localOrigin\",\"vec3\").add(\"ambient\",\"vec3\").add(\"diffuse\",\"vec3\").add(\"opacity\",\"float\").add(\"layerOpacity\",\"float\"),E.fragment.uniforms.add(\"view\",\"mat4\"),j.hasColorTexture&&E.fragment.uniforms.add(\"tex\",\"sampler2D\"),E.include(f,j),E.include(b,j),E.fragment.include(C),_.add(L`\n      void main() {\n        discardBySlice(vpos);\n        ${j.multipassTerrainEnabled?L`terrainDepthTest(gl_FragCoord, depth);`:\"\"}\n        ${j.hasColorTexture?L`\n        vec4 texColor = texture2D(tex, vuv0);\n        ${j.textureAlphaPremultiplied?\"texColor.rgb /= texColor.a;\":\"\"}\n        discardOrAdjustAlpha(texColor);`:L`vec4 texColor = vec4(1.0);`}\n        vec3 viewDirection = normalize(vpos - camPos);\n        ${1===j.pbrMode?\"applyPBRFactors();\":\"\"}\n        float ssao = evaluateAmbientOcclusionInverse();\n        ssao *= getBakedOcclusion();\n\n        float additionalAmbientScale = additionalDirectedAmbientLight(vpos + localOrigin);\n        vec3 additionalLight = ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n        ${j.receiveShadows?\"float shadow = readShadowMap(vpos, linearDepth);\":1===j.viewingMode?\"float shadow = lightingGlobalFactor * (1.0 - additionalAmbientScale);\":\"float shadow = 0.0;\"}\n        vec3 matColor = max(ambient, diffuse);\n        ${j.attributeColor?L`\n        vec3 albedo_ = mixExternalColor(vColor.rgb * matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ = layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));`:L`\n        vec3 albedo_ = mixExternalColor(matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ = layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        `}\n        ${L`\n        vec3 shadedNormal = normalize(vNormalWorld);\n        albedo_ *= 1.2;\n        vec3 viewForward = vec3(view[0][2], view[1][2], view[2][2]);\n        float alignmentLightView = clamp(dot(viewForward, -lightingMainDirection), 0.0, 1.0);\n        float transmittance = 1.0 - clamp(dot(viewForward, shadedNormal), 0.0, 1.0);\n        float treeRadialFalloff = vColor.r;\n        float backLightFactor = 0.5 * treeRadialFalloff * alignmentLightView * transmittance * (1.0 - shadow);\n        additionalLight += backLightFactor * lightingMainIntensity;`}\n        ${1===j.pbrMode||2===j.pbrMode?1===j.viewingMode?L`vec3 normalGround = normalize(vpos + localOrigin);`:L`vec3 normalGround = vec3(0.0, 0.0, 1.0);`:L``}\n        ${1===j.pbrMode||2===j.pbrMode?L`\n            float additionalAmbientIrradiance = additionalAmbientIrradianceFactor * lightingMainIntensity[2];\n            vec3 shadedColor = evaluateSceneLightingPBR(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight, viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);`:\"vec3 shadedColor = evaluateSceneLighting(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight);\"}\n        gl_FragColor = highlightSlice(vec4(shadedColor, opacity_), vpos);\n        ${j.OITEnabled?\"gl_FragColor = premultiplyAlpha(gl_FragColor);\":\"\"}\n      }\n    `)),E.include(g,j),E}var E=Object.freeze({__proto__:null,build:j});export{E as R,j as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{VertexTextureCoordinates as e}from\"../attributes/VertexTextureCoordinates.glsl.js\";import{glsl as t}from\"../../shaderModules/interfaces.js\";function n(n,a){const r=n.fragment;a.vertexTangents?(n.attributes.add(\"tangent\",\"vec4\"),n.varyings.add(\"vTangent\",\"vec4\"),2===a.doubleSidedMode?r.code.add(t`mat3 computeTangentSpace(vec3 normal) {\nfloat tangentHeadedness = gl_FrontFacing ? vTangent.w : -vTangent.w;\nvec3 tangent = normalize(gl_FrontFacing ? vTangent.xyz : -vTangent.xyz);\nvec3 bitangent = cross(normal, tangent) * tangentHeadedness;\nreturn mat3(tangent, bitangent, normal);\n}`):r.code.add(t`mat3 computeTangentSpace(vec3 normal) {\nfloat tangentHeadedness = vTangent.w;\nvec3 tangent = normalize(vTangent.xyz);\nvec3 bitangent = cross(normal, tangent) * tangentHeadedness;\nreturn mat3(tangent, bitangent, normal);\n}`)):(n.extensions.add(\"GL_OES_standard_derivatives\"),r.code.add(t`mat3 computeTangentSpace(vec3 normal, vec3 pos, vec2 st) {\nvec3 Q1 = dFdx(pos);\nvec3 Q2 = dFdy(pos);\nvec2 stx = dFdx(st);\nvec2 sty = dFdy(st);\nfloat det = stx.t * sty.s - sty.t * stx.s;\nvec3 T = stx.t * Q2 - sty.t * Q1;\nT = T - normal * dot(normal, T);\nT *= inversesqrt(max(dot(T,T), 1.e-10));\nvec3 B = sign(det) * cross(normal, T);\nreturn mat3(T, B, normal);\n}`)),0!==a.attributeTextureCoordinates&&(n.include(e,a),r.uniforms.add(\"normalTexture\",\"sampler2D\"),r.uniforms.add(\"normalTextureSize\",\"vec2\"),r.code.add(t`\n    vec3 computeTextureNormal(mat3 tangentSpace, vec2 uv) {\n      vtc.uv = uv;\n      ${a.supportsTextureAtlas?\"vtc.size = normalTextureSize;\":\"\"}\n      vec3 rawNormal = textureLookup(normalTexture, vtc).rgb * 2.0 - 1.0;\n      return tangentSpace * rawNormal;\n    }\n  `))}export{n as ComputeNormalTexture};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{glsl as t}from\"../../shaderModules/interfaces.js\";import{webglValidateShadersEnabled as e}from\"../../../../../webgl/RenderingContext.js\";function u(u,o){const r=t`\n  /*\n  *  ${o.name}\n  *  ${0===o.output?\"RenderOutput: Color\":1===o.output?\"RenderOutput: Depth\":3===o.output?\"RenderOutput: Shadow\":2===o.output?\"RenderOutput: Normal\":4===o.output?\"RenderOutput: Highlight\":\"\"}\n  */\n  `;e()&&(u.fragment.code.add(r),u.vertex.code.add(r))}export{u as HeaderComment};\n"],"sourceRoot":""}